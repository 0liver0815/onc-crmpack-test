<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stop the trial? — stopTrial • crmPack</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Stop the trial? — stopTrial" />
<meta property="og:description" content="This function returns whether to stop the trial." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crmPack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rolling-crm.html">Rolling CRM Example</a>
    </li>
    <li>
      <a href="../articles/simulations.html">Simulation study example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start_releases -->
<li class="dropdown">
	<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
Other releases
<span class="caret"></span></a><ul class="dropdown-menu" role="menu">
   <li><a href="../../index.html">latest</a></li>
   <li><a href="../..//index.html"></a></li>
</ul></li>
<!-- end_releases -->
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stop the trial?</h1>
    <small class="dont-index">Source: <a href='https://github.com/roche/crmPack/blob/master/R/Rules-methods.R'><code>R/Rules-methods.R</code></a></small>
    <div class="hidden name"><code>stopTrial.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function returns whether to stop the trial.</p>
    </div>

    <pre class="usage"><span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingList,ANY,ANY,ANY,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingAll,ANY,ANY,ANY,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingAny,ANY,ANY,ANY,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingCohortsNearDose,numeric,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingPatientsNearDose,numeric,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingMinCohorts,ANY,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingMinPatients,ANY,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingTargetProb,numeric,Samples,Model,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingMTDdistribution,numeric,Samples,Model,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingTargetBiomarker,numeric,Samples,DualEndpoint,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingHighestDose,numeric,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingTDCIRatio,ANY,Samples,ModelTox,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingTDCIRatio,ANY,missing,ModelTox,ANY</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>samples</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for StoppingGstarCIRatio,ANY,Samples,ModelTox,DataDual</span>
<span class='fu'>stopTrial</span><span class='op'>(</span>
  <span class='va'>stopping</span>,
  <span class='va'>dose</span>,
  <span class='va'>samples</span>,
  <span class='va'>model</span>,
  <span class='va'>data</span>,
  <span class='va'>TDderive</span>,
  <span class='va'>Effmodel</span>,
  <span class='va'>Effsamples</span>,
  <span class='va'>Gstarderive</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for StoppingGstarCIRatio,ANY,missing,ModelTox,DataDual</span>
<span class='fu'>stopTrial</span><span class='op'>(</span><span class='va'>stopping</span>, <span class='va'>dose</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>Effmodel</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>stopping</th>
      <td><p>The rule, an object of class
<code><a href='Stopping-class.html'>Stopping</a></code></p></td>
    </tr>
    <tr>
      <th>dose</th>
      <td><p>the recommended next best dose</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>the <code><a href='Samples-class.html'>Samples</a></code> object</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>The model input, an object of class <code><a href='Model-class.html'>Model</a></code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>The data input, an object of class <code><a href='Data-class.html'>Data</a></code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments</p></td>
    </tr>
    <tr>
      <th>TDderive</th>
      <td><p>the function which derives from the input, a vector of the posterior samples called
<code>TDsamples</code> of the dose
which has the probability of the occurrence of DLE equals to either the targetDuringTrial or
targetEndOfTrial, the final next best TDtargetDuringTrial (the dose with probability of the
occurrence of DLE equals to the targetDuringTrial)and TDtargetEndOfTrial estimate.</p></td>
    </tr>
    <tr>
      <th>Effmodel</th>
      <td><p>the efficacy model of <code><a href='ModelEff-class.html'>ModelEff</a></code> class object</p></td>
    </tr>
    <tr>
      <th>Effsamples</th>
      <td><p>the efficacy samples of <code><a href='Samples-class.html'>Samples</a></code> class object</p></td>
    </tr>
    <tr>
      <th>Gstarderive</th>
      <td><p>the function which derives from the input, a vector of the posterior Gstar (the dose
which gives the maximum gain value) samples
called <code>Gstarsamples</code>, the final next best Gstar estimate.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>logical value: <code>TRUE</code> if the trial can be stopped, <code>FALSE</code>
otherwise. It should have an attribute <code>message</code> which gives the reason
for the decision.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>stopTrial,StoppingList,ANY,ANY,ANY,ANY-method</code>: Stop based on multiple stopping rules</p></li>
<li><p><code>stopTrial,StoppingAll,ANY,ANY,ANY,ANY-method</code>: Stop based on fulfillment of all multiple stopping
rules</p></li>
<li><p><code>stopTrial,StoppingAny,ANY,ANY,ANY,ANY-method</code>: Stop based on fulfillment of any stopping rule</p></li>
<li><p><code>stopTrial,StoppingCohortsNearDose,numeric,ANY,ANY,Data-method</code>: Stop based on number of cohorts near to next best dose</p></li>
<li><p><code>stopTrial,StoppingPatientsNearDose,numeric,ANY,ANY,Data-method</code>: Stop based on number of patients near to next best
dose</p></li>
<li><p><code>stopTrial,StoppingMinCohorts,ANY,ANY,ANY,Data-method</code>: Stop based on minimum number of cohorts</p></li>
<li><p><code>stopTrial,StoppingMinPatients,ANY,ANY,ANY,Data-method</code>: Stop based on minimum number of patients</p></li>
<li><p><code>stopTrial,StoppingTargetProb,numeric,Samples,Model,ANY-method</code>: Stop based on probability of target tox interval</p></li>
<li><p><code>stopTrial,StoppingMTDdistribution,numeric,Samples,Model,ANY-method</code>: Stop based on MTD distribution</p></li>
<li><p><code>stopTrial,StoppingTargetBiomarker,numeric,Samples,DualEndpoint,ANY-method</code>: Stop based on probability of targeting biomarker</p></li>
<li><p><code>stopTrial,StoppingHighestDose,numeric,ANY,ANY,Data-method</code>: Stop when the highest dose is reached</p></li>
<li><p><code>stopTrial,StoppingTDCIRatio,ANY,Samples,ModelTox,ANY-method</code>: Stop based on 'StoppingTDCIRatio' class when
reaching the target ratio of the upper to the lower 95% credibility
interval of the estimate (TDtargetEndOfTrial). This is a stopping rule which incorporate only
DLE responses and DLE samples are given</p></li>
<li><p><code>stopTrial,StoppingTDCIRatio,ANY,missing,ModelTox,ANY-method</code>: Stop based on 'StoppingTDCIRatio' class
when reaching the target ratio of the upper to the lower 95% credibility
interval of the estimate (TDtargetEndOfTrial). This is a stopping rule which incorporate only
DLE responses and no DLE samples are involved</p></li>
<li><p><code>stopTrial,StoppingGstarCIRatio,ANY,Samples,ModelTox,DataDual-method</code>: Stop based on reaching the target ratio of the upper to the lower 95% credibility
interval of the estimate (the minimum of Gstar and TDtargetEndOfTrial). This is a stopping rule which
incorporate DLE and efficacy responses and DLE and efficacy samples are also used.</p></li>
<li><p><code>stopTrial,StoppingGstarCIRatio,ANY,missing,ModelTox,DataDual-method</code>: Stop based on reaching the target ratio of the upper to the lower 95% credibility
interval of the estimate (the minimum of Gstar and TDtargetEndOfTrial). This is a stopping rule which
incorporate DLE and efficacy responses without DLE and efficacy samples involved.</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='co'>## Example of combining stopping rules with '&amp;' and/or '|' operators</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>myStopping1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span><span class='op'>(</span>nCohorts<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                                  prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span><span class='op'>(</span>nPatients<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>myStopping1</span> <span class='op'>&amp;</span> <span class='va'>myStopping2</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>myStopping3</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create some data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rules</span></span>
<span class='r-in'><span class='va'>myStopping1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span><span class='op'>(</span>nCohorts<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                                  prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span><span class='op'>(</span>nPatients<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create a list of stopping rules (of class 'StoppingList') which will then be</span></span>
<span class='r-in'><span class='co'># summarized (in this specific example) with the 'any' function, meaning that the study </span></span>
<span class='r-in'><span class='co'># would be stopped if 'any' of the single stopping rules is TRUE.</span></span>
<span class='r-in'><span class='va'>mystopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingList.html'>StoppingList</a></span><span class='op'>(</span>stopList<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>myStopping1</span>,<span class='va'>myStopping2</span>,<span class='va'>myStopping3</span><span class='op'>)</span>,</span>
<span class='r-in'>                           summary<span class='op'>=</span><span class='va'>any</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the Trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]][[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 3"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]][[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of patients is 8 and thus below the prespecified minimum number 20"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create some data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rules</span></span>
<span class='r-in'><span class='va'>myStopping1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span><span class='op'>(</span>nCohorts<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                                  prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span><span class='op'>(</span>nPatients<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Combine the stopping rules, obtaining (in this specific example) a list of stopping </span></span>
<span class='r-in'><span class='co'># rules of class 'StoppingAll'</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>myStopping1</span> <span class='op'>|</span> <span class='va'>myStopping2</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='va'>myStopping3</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the Trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]][[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 3"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]][[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of patients is 8 and thus below the prespecified minimum number 20"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create some data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rules</span></span>
<span class='r-in'><span class='va'>myStopping1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span><span class='op'>(</span>nCohorts<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                                  prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>myStopping3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span><span class='op'>(</span>nPatients<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Combine the stopping rules, obtaining (in this specific example) a list of stopping </span></span>
<span class='r-in'><span class='co'># rules of class 'StoppingAny'</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>myStopping1</span> <span class='op'>|</span> <span class='va'>myStopping2</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>myStopping3</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the Trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] TRUE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 3"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[3]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of patients is 8 and thus below the prespecified minimum number 20"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if at least 3 </span></span>
<span class='r-in'><span class='co'># cohorts were already dosed within 1 +/- 0.2 of the next best dose</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingCohortsNearDose.html'>StoppingCohortsNearDose</a></span><span class='op'>(</span>nCohorts <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span class='r-in'>                                      percentage <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "0 cohorts lie within 0.2% of the next best dose 16. This is below the required 3 cohorts"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if at least 9 </span></span>
<span class='r-in'><span class='co'># patients were already dosed within 1 +/- 0.2 of the next best dose</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingPatientsNearDose.html'>StoppingPatientsNearDose</a></span><span class='op'>(</span>nPatients <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span class='r-in'>                                       percentage <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "0 patients lie within 0.2% of the next best dose 16. This is below the required 9 patients"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if at least 6 </span></span>
<span class='r-in'><span class='co'># cohorts were already dosed </span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span><span class='op'>(</span>nCohorts <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] TRUE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 6"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if at least 20 </span></span>
<span class='r-in'><span class='co'># patients were already dosed </span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span><span class='op'>(</span>nPatients <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Number of patients is 8 and thus below the prespecified minimum number 20"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if there is at least </span></span>
<span class='r-in'><span class='co'># 0.5 posterior probability that [0.2 =&lt; Prob(DLT | next-best-dose) &lt;= 0.35] </span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                                 prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>,</span>
<span class='r-in'>          model<span class='op'>=</span><span class='va'>model</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if there is at least </span></span>
<span class='r-in'><span class='co'># 0.9 probability that MTD &gt; 0.5*next_best_dose. Here MTD is defined as the dose for </span></span>
<span class='r-in'><span class='co'># which prob(DLE)=0.33</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMTDdistribution.html'>StoppingMTDdistribution</a></span><span class='op'>(</span>target <span class='op'>=</span> <span class='fl'>0.33</span>,</span>
<span class='r-in'>                                      thresh <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span class='r-in'>                                      prob <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>,</span>
<span class='r-in'>          model<span class='op'>=</span><span class='va'>model</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] TRUE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability of MTD above 50 % of current dose 16 is 96 % and thus above the required 90 %"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DataDual-class.html'>DataDual</a></span><span class='op'>(</span></span>
<span class='r-in'>  x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>,</span>
<span class='r-in'>      <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>50</span><span class='op'>)</span>,</span>
<span class='r-in'>  y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>,</span>
<span class='r-in'>      <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>  w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>, <span class='fl'>0.42</span>, <span class='fl'>0.59</span>, <span class='fl'>0.45</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>, <span class='fl'>0.55</span>, <span class='fl'>0.6</span>,</span>
<span class='r-in'>      <span class='fl'>0.52</span>, <span class='fl'>0.54</span>, <span class='fl'>0.56</span>, <span class='fl'>0.43</span>, <span class='fl'>0.41</span>, <span class='fl'>0.39</span>, <span class='fl'>0.34</span>, <span class='fl'>0.38</span>, <span class='fl'>0.21</span><span class='op'>)</span>,</span>
<span class='r-in'>  doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>             <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used best guess cohort indices!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the Dual-Endpoint model (in this case RW1)</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DualEndpointRW.html'>DualEndpointRW</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                        Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                        sigma2betaW <span class='op'>=</span> <span class='fl'>0.01</span>,</span>
<span class='r-in'>                        sigma2W <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0.1</span>, b<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span class='r-in'>                        rho <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>, b<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                        smooth <span class='op'>=</span> <span class='st'>"RW1"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># In this case target a dose achieving at least 0.9 of maximum biomarker level (efficacy)</span></span>
<span class='r-in'><span class='co'># and with a probability below 0.25 that prob(DLT)&gt;0.35 (safety)</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestDualEndpoint.html'>NextBestDualEndpoint</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>,</span>
<span class='r-in'>                               model<span class='op'>=</span><span class='va'>model</span>,</span>
<span class='r-in'>                               data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if if there is at </span></span>
<span class='r-in'><span class='co'># least 0.5 posterior probability that the biomarker (efficacy) is within the </span></span>
<span class='r-in'><span class='co'># biomarker target range of [0.9, 1.0] (relative to the maximum for the biomarker). </span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetBiomarker.html'>StoppingTargetBiomarker</a></span><span class='op'>(</span>target <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                      prob <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>,</span>
<span class='r-in'>          model<span class='op'>=</span><span class='va'>model</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target biomarker is 12 % for dose 6 and thus below the required 50 %"</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create the data</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>40</span>,</span>
<span class='r-in'>                 <span class='fl'>80</span>, <span class='fl'>80</span>, <span class='fl'>80</span><span class='op'>)</span>,</span>
<span class='r-in'>             y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>             cohort<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>6</span>, <span class='fl'>6</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>8</span>, <span class='fl'>8</span>, <span class='fl'>8</span><span class='op'>)</span>,</span>
<span class='r-in'>             doseGrid<span class='op'>=</span></span>
<span class='r-in'>               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,</span>
<span class='r-in'>                 <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Initialize the CRM model used to model the data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           cov<span class='op'>=</span></span>
<span class='r-in'>                             <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                                    nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>                           refDose<span class='op'>=</span><span class='fl'>56</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span></span>
<span class='r-in'><span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,</span>
<span class='r-in'>                       step<span class='op'>=</span><span class='fl'>2</span>,</span>
<span class='r-in'>                       samples<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span></span>
<span class='r-in'><span class='va'>myIncrements</span> <span class='op'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nextMaxDose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span><span class='op'>(</span><span class='va'>myIncrements</span>,</span>
<span class='r-in'>                       data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the rule which will be used to select the next best dose</span></span>
<span class='r-in'><span class='co'># based on the class 'NextBestNCRM'</span></span>
<span class='r-in'><span class='va'>myNextBest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                           overdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>                           maxOverdoseProb<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the next best dose</span></span>
<span class='r-in'><span class='va'>doseRecommendation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>myNextBest</span>,</span>
<span class='r-in'>                               doselimit<span class='op'>=</span><span class='va'>nextMaxDose</span>,</span>
<span class='r-in'>                               samples<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the stopping rule such that the study would be stopped if there is at least </span></span>
<span class='r-in'><span class='co'># 0.5 posterior probability that [0.2 =&lt; Prob(DLT | next-best-dose) &lt;= 0.35] </span></span>
<span class='r-in'><span class='va'>stopTarget</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.35</span><span class='op'>)</span>,</span>
<span class='r-in'>                                 prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## now use the StoppingHighestDose rule:</span></span>
<span class='r-in'><span class='va'>stopHigh</span> <span class='op'>&lt;-</span></span>
<span class='r-in'>  <span class='fu'><a href='StoppingHighestDose.html'>StoppingHighestDose</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span class='r-in'>  <span class='fu'><a href='StoppingPatientsNearDose.html'>StoppingPatientsNearDose</a></span><span class='op'>(</span>nPatients<span class='op'>=</span><span class='fl'>3</span>, percentage<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span class='r-in'>  <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span><span class='op'>(</span>target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span class='r-in'>                     prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## and combine everything:</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='va'>stopTarget</span> <span class='op'>|</span> <span class='va'>stopHigh</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Then evaluate if to stop the trial</span></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>, </span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>doseRecommendation</span><span class='op'>$</span><span class='va'>value</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>,</span>
<span class='r-in'>          model<span class='op'>=</span><span class='va'>model</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target toxicity is 49 % for dose 62 and thus below the required 50 %"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]][[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Next best dose is 62 and thus not the highest dose"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]][[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "0 patients lie within 0% of the next best dose 62. This is below the required 3 patients"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")[[2]][[3]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Probability for target toxicity is 28 % for dose 62 and thus below the required 50 %"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##define the stopping rules based on the 'StoppingTDCIRatio' class</span></span>
<span class='r-in'><span class='co'>##Using only DLE responses with samples</span></span>
<span class='r-in'><span class='co'>## we need a data object with doses &gt;= 1:</span></span>
<span class='r-in'><span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>150</span>,<span class='fl'>200</span>,<span class='fl'>225</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>           y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>           doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>25</span>,to<span class='op'>=</span><span class='fl'>300</span>,by<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used best guess cohort indices!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##model can be specified of 'Model' or 'ModelTox' class</span></span>
<span class='r-in'><span class='co'>##For example, the 'logisticIndepBeta' class model</span></span>
<span class='r-in'><span class='va'>model</span><span class='op'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##define MCMC options</span></span>
<span class='r-in'><span class='co'>##for illustration purpose we use 10 burn-in and generate 50 samples</span></span>
<span class='r-in'><span class='va'>options</span><span class='op'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>10</span>,step<span class='op'>=</span><span class='fl'>2</span>,samples<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##samples of 'Samples' class</span></span>
<span class='r-in'><span class='va'>samples</span><span class='op'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>,<span class='va'>model</span>,<span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##define the 'StoppingTDCIRatio' class</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTDCIRatio.html'>StoppingTDCIRatio</a></span><span class='op'>(</span>targetRatio<span class='op'>=</span><span class='fl'>5</span>,</span>
<span class='r-in'>                                       targetEndOfTrial<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span></span>
<span class='r-in'><span class='va'>tdNextBest</span><span class='op'>&lt;-</span><span class='fu'><a href='NextBestTDsamples.html'>NextBestTDsamples</a></span><span class='op'>(</span>targetDuringTrial<span class='op'>=</span><span class='fl'>0.35</span>,targetEndOfTrial<span class='op'>=</span><span class='fl'>0.3</span>,</span>
<span class='r-in'>                              derive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>TDsamples</span><span class='op'>)</span><span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>TDsamples</span>,probs<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>RecommendDose</span><span class='op'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>tdNextBest</span>,doselimit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span><span class='op'>)</span>,samples<span class='op'>=</span><span class='va'>samples</span>,</span>
<span class='r-in'>                        model<span class='op'>=</span><span class='va'>model</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span></span>
<span class='r-in'><span class='co'>##use 0.3 as the target proability of DLE at the end of the trial</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>,dose<span class='op'>=</span><span class='va'>RecommendDose</span><span class='op'>$</span><span class='va'>nextdose</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>samples</span>,model<span class='op'>=</span><span class='va'>model</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] TRUE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Recommended next best dose is NA"</span>
<span class='r-in'><span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span></span>
<span class='r-in'><span class='co'>##define the stopping rules based on the 'StoppingTDCIRatio' class</span></span>
<span class='r-in'><span class='co'>##Using only DLE responses </span></span>
<span class='r-in'><span class='co'>## we need a data object with doses &gt;= 1:</span></span>
<span class='r-in'><span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='Data-class.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>150</span>,<span class='fl'>200</span>,<span class='fl'>225</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>           y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>           doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>25</span>,to<span class='op'>=</span><span class='fl'>300</span>,by<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used best guess cohort indices!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##model must be of 'ModelTox' class</span></span>
<span class='r-in'><span class='co'>##For example, the 'logisticIndepBeta' class model</span></span>
<span class='r-in'><span class='va'>model</span><span class='op'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##define the 'StoppingTDCIRatio' class</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingTDCIRatio.html'>StoppingTDCIRatio</a></span><span class='op'>(</span>targetRatio<span class='op'>=</span><span class='fl'>5</span>,</span>
<span class='r-in'>                                targetEndOfTrial<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span></span>
<span class='r-in'><span class='va'>tdNextBest</span><span class='op'>&lt;-</span><span class='fu'><a href='NextBestTD.html'>NextBestTD</a></span><span class='op'>(</span>targetDuringTrial<span class='op'>=</span><span class='fl'>0.35</span>,targetEndOfTrial<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>RecommendDose</span><span class='op'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>tdNextBest</span>,doselimit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span><span class='op'>)</span>,model<span class='op'>=</span><span class='va'>model</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span></span>
<span class='r-in'><span class='co'>##use 0.3 as the target proability of DLE at the end of the trial</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>,dose<span class='op'>=</span><span class='va'>RecommendDose</span><span class='op'>$</span><span class='va'>nextdose</span>,</span>
<span class='r-in'>          model<span class='op'>=</span><span class='va'>model</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"messgae")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "95% CI is ( 15.2619 , 173.8695 ), Ratio = 11.3924 is  greater than targetRatio = 5"</span>
<span class='r-in'><span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span></span>
<span class='r-in'><span class='co'>##define the stopping rules based on the 'StoppingGstarCIRatio' class</span></span>
<span class='r-in'><span class='co'>##Using both DLE and efficacy responses</span></span>
<span class='r-in'><span class='co'>## we need a data object with doses &gt;= 1:</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span><span class='fu'><a href='DataDual-class.html'>DataDual</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>300</span>,<span class='fl'>250</span>,<span class='fl'>150</span><span class='op'>)</span>,</span>
<span class='r-in'>                y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>                w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span><span class='op'>)</span>,</span>
<span class='r-in'>                doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span>,</span>
<span class='r-in'>                placebo<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used best guess cohort indices!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##DLEmodel must be of 'ModelTox' class</span></span>
<span class='r-in'><span class='co'>##For example, the 'logisticIndepBeta' class model</span></span>
<span class='r-in'><span class='va'>DLEmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Effmodel must be  of 'ModelEff' class</span></span>
<span class='r-in'><span class='co'>##For example, the 'Effloglog' class model</span></span>
<span class='r-in'><span class='va'>Effmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='Effloglog.html'>Effloglog</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>,<span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,nu<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>,b<span class='op'>=</span><span class='fl'>0.025</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span>,c<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##for illustration purpose we use 10 burn-in and generate 50 samples</span></span>
<span class='r-in'><span class='va'>options</span><span class='op'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>10</span>,step<span class='op'>=</span><span class='fl'>2</span>,samples<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##DLE and efficacy samples must be of 'Samples' class</span></span>
<span class='r-in'><span class='va'>DLEsamples</span><span class='op'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>,<span class='va'>DLEmodel</span>,<span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>Effsamples</span><span class='op'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>,<span class='va'>Effmodel</span>,<span class='va'>options</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##define the 'StoppingGstarCIRatio' class</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingGstarCIRatio.html'>StoppingGstarCIRatio</a></span><span class='op'>(</span>targetRatio<span class='op'>=</span><span class='fl'>5</span>,</span>
<span class='r-in'>                                          targetEndOfTrial<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span></span>
<span class='r-in'><span class='va'>mynextbest</span><span class='op'>&lt;-</span><span class='fu'><a href='NextBestMaxGainSamples.html'>NextBestMaxGainSamples</a></span><span class='op'>(</span>DLEDuringTrialtarget<span class='op'>=</span><span class='fl'>0.35</span>,</span>
<span class='r-in'>                                   DLEEndOfTrialtarget<span class='op'>=</span><span class='fl'>0.3</span>,</span>
<span class='r-in'>                                   TDderive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>TDsamples</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>                                     <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>TDsamples</span>,prob<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>}</span>,</span>
<span class='r-in'>                                   Gstarderive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>Gstarsamples</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>                                     <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Gstarsamples</span>,prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>RecommendDose</span><span class='op'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>mynextbest</span>,doselimit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span><span class='op'>)</span>,samples<span class='op'>=</span><span class='va'>DLEsamples</span>,model<span class='op'>=</span><span class='va'>DLEmodel</span>,</span>
<span class='r-in'>                        data<span class='op'>=</span><span class='va'>data</span>,Effmodel<span class='op'>=</span><span class='va'>Effmodel</span>,Effsamples<span class='op'>=</span><span class='va'>Effsamples</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Estimated TD 35 = 14.8679719869239  not within dose Grid"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Estimated TD 30 = 9.60973788445752  not within dose Grid"</span>
<span class='r-in'><span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span></span>
<span class='r-in'><span class='co'>##use 0.3 as the target proability of DLE at the end of the trial </span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>,</span>
<span class='r-in'>          dose<span class='op'>=</span><span class='va'>RecommendDose</span><span class='op'>$</span><span class='va'>nextdose</span>,</span>
<span class='r-in'>          samples<span class='op'>=</span><span class='va'>DLEsamples</span>,</span>
<span class='r-in'>          model<span class='op'>=</span><span class='va'>DLEmodel</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span>,</span>
<span class='r-in'>          TDderive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>TDsamples</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>            <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>TDsamples</span>,prob<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>}</span>,</span>
<span class='r-in'>          Effmodel<span class='op'>=</span><span class='va'>Effmodel</span>,</span>
<span class='r-in'>          Effsamples<span class='op'>=</span><span class='va'>Effsamples</span>,</span>
<span class='r-in'>          Gstarderive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>Gstarsamples</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>            <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Gstarsamples</span>,prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] TRUE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Recommended next best dose is NA"</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span></span>
<span class='r-in'><span class='co'>##define the stopping rules based on the 'StoppingGstarCIRatio' class</span></span>
<span class='r-in'><span class='co'>##Using both DLE and efficacy responses</span></span>
<span class='r-in'><span class='co'>## we need a data object with doses &gt;= 1:</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span><span class='fu'><a href='DataDual-class.html'>DataDual</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>300</span>,<span class='fl'>250</span>,<span class='fl'>150</span><span class='op'>)</span>,</span>
<span class='r-in'>                y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,</span>
<span class='r-in'>                w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span><span class='op'>)</span>,</span>
<span class='r-in'>                doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span>,</span>
<span class='r-in'>                placebo<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used default patient IDs!</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Used best guess cohort indices!</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##DLEmodel must be of 'ModelTox' class</span></span>
<span class='r-in'><span class='co'>##For example, the 'logisticIndepBeta' class model</span></span>
<span class='r-in'><span class='va'>DLEmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Effmodel must be  of 'ModelEff' class</span></span>
<span class='r-in'><span class='co'>##For example, the 'Effloglog' class model</span></span>
<span class='r-in'><span class='va'>Effmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='Effloglog.html'>Effloglog</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>,<span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,nu<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>,b<span class='op'>=</span><span class='fl'>0.025</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span>,c<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##define the 'StoppingGstarCIRatio' class</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingGstarCIRatio.html'>StoppingGstarCIRatio</a></span><span class='op'>(</span>targetRatio<span class='op'>=</span><span class='fl'>5</span>,</span>
<span class='r-in'>                                   targetEndOfTrial<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span></span>
<span class='r-in'><span class='va'>mynextbest</span><span class='op'>&lt;-</span><span class='fu'><a href='NextBestMaxGain.html'>NextBestMaxGain</a></span><span class='op'>(</span>DLEDuringTrialtarget<span class='op'>=</span><span class='fl'>0.35</span>,DLEEndOfTrialtarget<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>RecommendDose</span><span class='op'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span><span class='op'>(</span><span class='va'>mynextbest</span>,doselimit<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span><span class='op'>)</span>,model<span class='op'>=</span><span class='va'>DLEmodel</span>,</span>
<span class='r-in'>                        Effmodel<span class='op'>=</span><span class='va'>Effmodel</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span></span>
<span class='r-in'><span class='co'>##use 0.3 as the target proability of DLE at the end of the trial</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>stopTrial</span><span class='op'>(</span>stopping<span class='op'>=</span><span class='va'>myStopping</span>,dose<span class='op'>=</span><span class='va'>RecommendDose</span><span class='op'>$</span><span class='va'>nextdose</span>,model<span class='op'>=</span><span class='va'>DLEmodel</span>,</span>
<span class='r-in'>          data<span class='op'>=</span><span class='va'>data</span>, Effmodel<span class='op'>=</span><span class='va'>Effmodel</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] FALSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"message")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Gstar estimate is 94.942 with 95% CI ( 16.771 , 537.4745 ) and its ratio = 32.0479"                </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [2] "TDtargetEndOfTrial estimate is  81.4924 with 95% CI ( 24.3435 , 272.804 ) and its ratio= 11.2064"  </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [3] "TDatrgetEndOfTrial estimate is smaller with ratio = 11.2064 which is  greater than targetRatio = 5"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Giuseppe Palermo, Thomas Jaki, Jiawen Zhu, Ziwei Liao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


