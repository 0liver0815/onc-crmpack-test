<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Class for the efficacy model in flexible form for prior expressed in form of pseudo data — EffFlexi-class • crmPack</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Class for the efficacy model in flexible form for prior expressed in form of pseudo data — EffFlexi-class" />
<meta property="og:description" content="This is a class where a flexible form is used to describe the relationship between the efficacy
responses and the dose levels. This flexible form aims to capture different shape for the
dose-efficacy curve and the mean efficacy responses at each dose level are estimated using MCMC.
In addition, the first (RW1) or second order (RW2) random walk model can be used for smoothing data. That is
the random walk model is used to model the first or the second order difference of the mean
efficacy responses to its neighboring dose levels of their mean efficacy responses.
The flexible form is specified as
$$\mathbf{W}\vert\boldsymbol{\beta_w}, \sigma^2 \sim Normal (\mathbf{X}_w \boldsymbol{\beta_w}, \sigma^2 \mathbf{I})$$
where \(\mathbf{W}\) represent the column vector of the efficacy responses, \(\boldsymbol{\beta_w}\)
is th column vector of the mean efficacy responses for all dose levels, \(\mathbf{X_w}\) is the
design matrix with entries \(I_{i(j)}\) which gives a value 1 if subject i is allocated to
dose j. The \(\sigma^2\) (sigma2) is the variance of the efficacy responses which can be either fixed or from
an inverse gamma distribution." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crmPack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rolling-crm.html">Rolling CRM Example</a>
    </li>
    <li>
      <a href="../articles/simulations.html">Simulation study example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Class for the efficacy model in flexible form for prior expressed in form of pseudo data</h1>
    <small class="dont-index">Source: <a href='https://github.com/roche/crmPack/blob/master/R/Model-class.R'><code>R/Model-class.R</code></a></small>
    <div class="hidden name"><code>EffFlexi-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a class where a flexible form is used to describe the relationship between the efficacy
responses and the dose levels. This flexible form aims to capture different shape for the
dose-efficacy curve and the mean efficacy responses at each dose level are estimated using MCMC.
In addition, the first (RW1) or second order (RW2) random walk model can be used for smoothing data. That is
the random walk model is used to model the first or the second order difference of the mean
efficacy responses to its neighboring dose levels of their mean efficacy responses.
The flexible form is specified as
$$\mathbf{W}\vert\boldsymbol{\beta_w}, \sigma^2 \sim Normal (\mathbf{X}_w \boldsymbol{\beta_w}, \sigma^2 \mathbf{I})$$
where \(\mathbf{W}\) represent the column vector of the efficacy responses, \(\boldsymbol{\beta_w}\)
is th column vector of the mean efficacy responses for all dose levels, \(\mathbf{X_w}\) is the
design matrix with entries \(I_{i(j)}\) which gives a value 1 if subject i is allocated to
dose j. The \(\sigma^2\) (sigma2) is the variance of the efficacy responses which can be either fixed or from
an inverse gamma distribution.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The RW1 model is given as
$$\beta_{W,(j)} - \beta_{W,(j-1)} \sim Normal(0, \sigma^{2}_{\beta_{W}})$$
where \(\beta_{W,(j)}\) is the mean efficacy responses at dose j
For the RW2 is given as
$$\beta_{W,(j-2)} - 2 \beta_{W,(j-1)} + \beta_{W,(j)} \sim Normal(0, \sigma^{2}_{\beta_{W}})$$
The variance parameter \(\sigma^{2}_{\beta_{W}}\). The variance \(\sigma^{2}_{\beta_{W}}\)
(sigma2betaW) will be the same at all dose levels and can
either be fixed or assigned an inverse gamma prior distribution.</p>
<p>The <code>Eff</code> and <code>Effdose</code> are the pseudo efficacy responses and dose levels at which these
pseudo efficacy responses are observed at. (see more details for <code><a href='Effloglog-class.html'>Effloglog</a></code> class)
<code>Eff</code> and <code>Effdose</code> must be vector of at least length 2. The values or elements in vectors
<code>Eff</code> or <code>Effdose</code> must put in the same position with its corresponding value in the other
vector. The <code>sigma2</code> is the prior variance of the flexible efficacy form. The variance is either specified
with a single scalar value (fixed) or positive scalar value have to be specified for the <code>a</code> shape and
<code>b</code> slope parameter for th inverse gamma distribution. Similarly, <code>sigma2betaW</code> is the prior variance
of the random walk model which can be specified with a single scalar (fixed) value or specifying positive
scalar values for the shape <code>a</code> and rate <code>b</code> parameters for the inverse gamma distributions.
This model will output the updated value or the updated values of the parameters of the inverse gamma
distributions for \(sigma^2\) (sigma2) and \(\sigma^2_{\beta_W}\) (<code>sigma2betaW</code>)</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>Eff</code></dt><dd><p>the pseudo efficacy responses. A vector of at least length 2 with the elements here and its
corresponding value in <code>Effdose</code> must be specified in the same position. (see details above)</p></dd>

<dt><code>Effdose</code></dt><dd><p>the dose levels at which the pseudo efficacy responses are observed. This is a vector of at
least length 2 and the elements here and its corresponding value in <code>Eff</code> must be specified in the
same position. (see details from above)</p></dd>

<dt><code>sigma2</code></dt><dd><p>the prior variance of the flexible efficacy form. It can be specified with a single positive
scalar or specifying <code>a</code>, the shape and <code>b</code>, the rate parameter of the inverse gamma
distribution. (see details from above)</p></dd>

<dt><code>sigma2betaW</code></dt><dd><p>the prior variance of the random walk model for the mean efficacy responses. A single
positive scalar can be specified or specifying <code>a</code>, the shape and <code>b</code>, the rate parameter of
the inverse gamma distribution (see details from above)</p></dd>

<dt><code>useFixed</code></dt><dd><p>a list of with logical value to each of the parameters <code>sigma2</code> and <code>sigma2betaw</code>
indicating whether a fixed value is used or not; this slot is needed for internal purposes and not to
be touched by the user.</p></dd>

<dt><code>useRW1</code></dt><dd><p>for specifying the random walk model for the mean efficacy responses; if <code>TRUE</code>,
first order random walk model is used, otherwise the second-order random walk model.</p></dd>

<dt><code>designW</code></dt><dd><p>is the design matrix for the efficacy responses. If only the pseudo efficacy responses
are used, this will be the design matrix of the pseudo efficacy responses. If there are some observed
efficacy responses available. It will be the design matrix based on both the pseudo and the observed
efficacy responses.</p></dd>

<dt><code>RWmat</code></dt><dd><p>is the the difference matrix for the random walk model. This slot is needed for internal
purposes and not to be touched by the user.</p></dd>

<dt><code>RWmatRank</code></dt><dd><p>is the rank of the difference matrix. This slot is needed for internal purposes and not
to be touched by the user.</p></dd>

</dl>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'>##Obtain prior estimates for the EffFlexi (efficacy model) given the pseudo data.</span></span>
<span class='r-in'><span class='co'>##First define an empty data set by only define the dose levels used in the study</span></span>
<span class='r-in'><span class='co'>## 12 dose levels are usesd from 25 to 300 mg with increments of 25.</span></span>
<span class='r-in'><span class='va'>emptydata</span><span class='op'>&lt;-</span><span class='fu'><a href='DataDual-class.html'>DataDual</a></span><span class='op'>(</span>doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>data</span><span class='op'>&lt;-</span><span class='va'>emptydata</span></span>
<span class='r-in'><span class='co'>## define the pseudo data as first fixed 2 dose levels 25 and 300 mg and</span></span>
<span class='r-in'><span class='co'>## specified in (Effdose slot).</span></span>
<span class='r-in'><span class='co'>## Then the efficacy responses observed at these two dose levels are 1.223 and 2.513 and</span></span>
<span class='r-in'><span class='co'>## specified in (Eff slot).</span></span>
<span class='r-in'><span class='co'>## The prior variance of the pseudo efficacy responses. This can be either a fixed value of</span></span>
<span class='r-in'><span class='co'>## specifying the shape (a) and the rate (b) parameters for the inverse gamma distribution</span></span>
<span class='r-in'><span class='co'>## in (sigma2 slot). The prior variance of the random walk model which can be a fixed value or</span></span>
<span class='r-in'><span class='co'>## two value for the shape (a) and rate (b) parameter of the inverse gamma distribution in</span></span>
<span class='r-in'><span class='co'>## (sigma2betaW slot). The data are specified in (data slot)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>Effmodel</span><span class='op'>&lt;-</span> <span class='fu'><a href='EffFlexi.html'>EffFlexi</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>, <span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>                    sigma2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0.1</span>,b<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>,sigma2betaW<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>20</span>,b<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span>,</span>
<span class='r-in'>                    smooth<span class='op'>=</span><span class='st'>"RW2"</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Obtain estimates from the model given some observed responses</span></span>
<span class='r-in'><span class='co'>## first specified the data</span></span>
<span class='r-in'><span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='DataDual-class.html'>DataDual</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>100</span>,<span class='fl'>100</span>,<span class='fl'>225</span>,<span class='fl'>300</span><span class='op'>)</span>,y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>               w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span><span class='op'>)</span>,</span>
<span class='r-in'>               doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Used default patient IDs!</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Used best guess cohort indices!</span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>Effmodel</span><span class='op'>&lt;-</span> <span class='fu'><a href='EffFlexi.html'>EffFlexi</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>, <span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>                    sigma2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0.1</span>,b<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>,sigma2betaW<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>20</span>,b<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span>,</span>
<span class='r-in'>                    smooth<span class='op'>=</span><span class='st'>"RW2"</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Giuseppe Palermo, Thomas Jaki, Jiawen Zhu, Ziwei Liao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


