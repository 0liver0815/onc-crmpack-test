<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit method for the Samples class — fit • crmPack</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit method for the Samples class — fit" />
<meta property="og:description" content="Note this new generic function is necessary because the fitted
function only allows the first argument object to appear in the
signature. But we need also other arguments in the signature." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crmPack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/guidelines.html">Guidelines for developers and maintainer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit method for the Samples class</h1>
    <small class="dont-index">Source: <a href='https://github.com/roche/crmPack/blob/master/R/Samples-methods.R'><code>R/Samples-methods.R</code></a></small>
    <div class="hidden name"><code>fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Note this new generic function is necessary because the <code><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></code>
function only allows the first argument <code>object</code> to appear in the
signature. But we need also other arguments in the signature.</p>
    </div>

    <pre class="usage"><span class='fu'>fit</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>model</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for Samples,Model,Data</span>
<span class='fu'>fit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>model</span>,
  <span class='va'>data</span>,
  points <span class='op'>=</span> <span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span>,
  quantiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>,
  middle <span class='op'>=</span> <span class='va'>mean</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for Samples,DualEndpoint,DataDual</span>
<span class='fu'>fit</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>model</span>, <span class='va'>data</span>, quantiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>, middle <span class='op'>=</span> <span class='va'>mean</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for Samples,LogisticIndepBeta,Data</span>
<span class='fu'>fit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>model</span>,
  <span class='va'>data</span>,
  points <span class='op'>=</span> <span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span>,
  quantiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>,
  middle <span class='op'>=</span> <span class='va'>mean</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for Samples,Effloglog,DataDual</span>
<span class='fu'>fit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>model</span>,
  <span class='va'>data</span>,
  points <span class='op'>=</span> <span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span>,
  quantiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>,
  middle <span class='op'>=</span> <span class='va'>mean</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for Samples,EffFlexi,DataDual</span>
<span class='fu'>fit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>model</span>,
  <span class='va'>data</span>,
  points <span class='op'>=</span> <span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span>,
  quantiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>,
  middle <span class='op'>=</span> <span class='va'>mean</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>the <code><a href='Samples-class.html'>Samples</a></code> object</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>the <code><a href='Model-class.html'>Model</a></code> object</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>the <code><a href='Data-class.html'>Data</a></code> object</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>unused</p></td>
    </tr>
    <tr>
      <th>points</th>
      <td><p>at which dose levels is the fit requested? default is the dose
grid</p></td>
    </tr>
    <tr>
      <th>quantiles</th>
      <td><p>the quantiles to be calculated (default: 0.025 and
0.975)</p></td>
    </tr>
    <tr>
      <th>middle</th>
      <td><p>the function for computing the middle point. Default:
<code><a href='https://rdrr.io/r/base/mean.html'>mean</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>the data frame with required information (see method details)</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>fit,Samples,Model,Data-method</code>: This method returns a data frame with dose, middle, lower
and upper quantiles for the dose-toxicity curve</p></li>
<li><p><code>fit,Samples,DualEndpoint,DataDual-method</code>: This method returns a data frame with dose, and middle,
lower and upper quantiles, for both the dose-tox and dose-biomarker (suffix
"Biomarker") curves, for all grid points (Note that currently only the grid
points can be used, because the DualEndpointRW models only allow that)</p></li>
<li><p><code>fit,Samples,LogisticIndepBeta,Data-method</code>: This method return a data frame with dose, middle lower and upper quantiles 
for the dose-DLE curve using DLE samples for &#8220;LogisticIndepBeta&#8221; model class</p></li>
<li><p><code>fit,Samples,Effloglog,DataDual-method</code>: This method returns a data frame with dose, middle, lower, upper quantiles for 
the dose-efficacy curve using efficacy samples for &#8220;Effloglog&#8221; model class</p></li>
<li><p><code>fit,Samples,EffFlexi,DataDual-method</code>: This method returns a data frame with dose, middle, lower and upper 
quantiles for the dose-efficacy curve using efficacy samples for &#8220;EffFlexi&#8221; 
model class</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Create some data</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,
             y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,
             cohort <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,
             doseGrid <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                          <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>10</span>, to <span class='op'>=</span> <span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize a model </span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.85</span>, <span class='fl'>1</span><span class='op'>)</span>,
                           cov <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                           refDose <span class='op'>=</span> <span class='fl'>56</span><span class='op'>)</span>

<span class='co'># Get posterior for all model parameters</span>
<span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin <span class='op'>=</span> <span class='fl'>100</span>,
                       step <span class='op'>=</span> <span class='fl'>2</span>,
                       samples <span class='op'>=</span> <span class='fl'>2000</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span>
<span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span>

<span class='co'># Extract the posterior mean  (and empirical 2.5 and 97.5 percentile)</span>
<span class='co'># for the prob(DLT) by doses</span>
<span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='fu'>fit</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>samples</span>,
              model <span class='op'>=</span> <span class='va'>model</span>,
              data <span class='op'>=</span> <span class='va'>data</span>,
              quantiles<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>,
              middle<span class='op'>=</span><span class='va'>mean</span><span class='op'>)</span>


<span class='co'># ----------------------------------------------</span>
<span class='co'># A different example using a different model</span>
<span class='co'>## we need a data object with doses &gt;= 1:</span>
<span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='Data.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>150</span>,<span class='fl'>200</span>,<span class='fl'>225</span>,<span class='fl'>300</span><span class='op'>)</span>,
           y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,
           doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>25</span>,to<span class='op'>=</span><span class='fl'>300</span>,by<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>

<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,
                           DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,
                           DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,
                           data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>
<span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,
                       step<span class='op'>=</span><span class='fl'>2</span>,
                       samples<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='co'>## samples must be from 'Samples' class (object slot in fit)</span>
<span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>,<span class='va'>model</span>,<span class='va'>options</span><span class='op'>)</span>

<span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='fu'>fit</span><span class='op'>(</span>object<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>, data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>



<span class='co'># Create some data</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DataDual.html'>DataDual</a></span><span class='op'>(</span>
  x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>,
      <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>50</span><span class='op'>)</span>,
  y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>,
      <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
  w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>, <span class='fl'>0.42</span>, <span class='fl'>0.59</span>, <span class='fl'>0.45</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>, <span class='fl'>0.55</span>, <span class='fl'>0.6</span>,
      <span class='fl'>0.52</span>, <span class='fl'>0.54</span>, <span class='fl'>0.56</span>, <span class='fl'>0.43</span>, <span class='fl'>0.41</span>, <span class='fl'>0.39</span>, <span class='fl'>0.34</span>, <span class='fl'>0.38</span>, <span class='fl'>0.21</span><span class='op'>)</span>,
  doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
             <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>10</span>, to<span class='op'>=</span><span class='fl'>80</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='co'># Initialize the Dual-Endpoint model (in this case RW1)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DualEndpointRW.html'>DualEndpointRW</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
                        Sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,
                        sigma2betaW <span class='op'>=</span> <span class='fl'>0.01</span>,
                        sigma2W <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0.1</span>, b<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>,
                        rho <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>, b<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
                        smooth <span class='op'>=</span> <span class='st'>"RW1"</span><span class='op'>)</span>

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,
                       step<span class='op'>=</span><span class='fl'>2</span>,
                       samples<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>94</span><span class='op'>)</span>
<span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>model</span>, <span class='va'>options</span><span class='op'>)</span>

<span class='co'># Extract the posterior mean  (and empirical 2.5 and 97.5 percentile)</span>
<span class='co'># for the prob(DLT) by doses and the Biomarker by doses</span>
<span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='fu'>fit</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>samples</span>,
              model <span class='op'>=</span> <span class='va'>model</span>,
              data <span class='op'>=</span> <span class='va'>data</span>,
              quantiles<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.975</span><span class='op'>)</span>,
              middle<span class='op'>=</span><span class='va'>mean</span><span class='op'>)</span>
<span class='co'>##Obtain the 'fit' the middle, uppper and lower quantiles for the dose-DLE curve</span>
<span class='co'>## at all dose levels using a DLE sample, a DLE model and the data</span>
<span class='co'>## samples must be from 'Samples' class (object slot)</span>
<span class='co'>## we need a data object with doses &gt;= 1:</span>
<span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='Data.html'>Data</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>150</span>,<span class='fl'>200</span>,<span class='fl'>225</span>,<span class='fl'>300</span><span class='op'>)</span>,
           y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,
           doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fl'>25</span>,to<span class='op'>=</span><span class='fl'>300</span>,by<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'><span class='co'>## model must be from 'Model' or 'ModelTox' class e.g using 'LogisticIbdepBeta' model class</span>
<span class='va'>model</span><span class='op'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>
<span class='co'>##options for MCMC</span>
<span class='va'>options</span><span class='op'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,step<span class='op'>=</span><span class='fl'>2</span>,samples<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='co'>## samples must be from 'Samples' class (object slot in fit)</span>
<span class='va'>samples</span><span class='op'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span><span class='va'>data</span>,<span class='va'>model</span>,<span class='va'>options</span><span class='op'>)</span>

<span class='fu'>fit</span><span class='op'>(</span>object<span class='op'>=</span><span class='va'>samples</span>, model<span class='op'>=</span><span class='va'>model</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    dose    middle      lower     upper
#&gt; 1    25 0.2362155 0.08981218 0.4190492
#&gt; 2    50 0.3682220 0.20111117 0.5781557
#&gt; 3    75 0.4575540 0.27620943 0.6661194
#&gt; 4   100 0.5223768 0.33161940 0.7239995
#&gt; 5   125 0.5717475 0.37825701 0.7709958
#&gt; 6   150 0.6107229 0.40917199 0.8141918
#&gt; 7   175 0.6423542 0.42871110 0.8437866
#&gt; 8   200 0.6685943 0.44575657 0.8651832
#&gt; 9   225 0.6907535 0.46059389 0.8819519
#&gt; 10  250 0.7097445 0.47392655 0.8953912
#&gt; 11  275 0.7262234 0.48877922 0.9063659
#&gt; 12  300 0.7406746 0.51041966 0.9148683</div><div class='input'><span class='co'>##Obtain the 'fit' the middle, uppper and lower quantiles for the dose-efficacy curve</span>
<span class='co'>## at all dose levels using an efficacy sample, a pseudo efficacy model and the data</span>
<span class='co'>## data must be from 'DataDual' class</span>
<span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='DataDual.html'>DataDual</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>300</span>,<span class='fl'>250</span>,<span class='fl'>150</span><span class='op'>)</span>,
               y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
               w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span><span class='op'>)</span>,
               doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span>,
               placebo<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'><span class='co'>## model must be from 'ModelEff' e.g using 'Effloglog' class</span>
<span class='va'>Effmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='Effloglog.html'>Effloglog</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>,<span class='fl'>2.513</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,nu<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>,b<span class='op'>=</span><span class='fl'>0.025</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span>,c<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
<span class='co'>## samples must be from 'Samples' class (object slot in fit)</span>
<span class='va'>options</span><span class='op'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,step<span class='op'>=</span><span class='fl'>2</span>,samples<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='va'>Effsamples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>data</span>,model<span class='op'>=</span><span class='va'>Effmodel</span>,options<span class='op'>=</span><span class='va'>options</span><span class='op'>)</span>
<span class='fu'>fit</span><span class='op'>(</span>object<span class='op'>=</span><span class='va'>Effsamples</span>, model<span class='op'>=</span><span class='va'>Effmodel</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    dose    middle     lower     upper
#&gt; 1    25 0.4462888 0.1965514 0.6785599
#&gt; 2    50 0.8075228 0.6213108 0.9607797
#&gt; 3    75 0.9901919 0.8072546 1.1618406
#&gt; 4   100 1.1096741 0.8958233 1.3277248
#&gt; 5   125 1.1973191 0.9623318 1.4458898
#&gt; 6   150 1.2659743 1.0144301 1.5347350
#&gt; 7   175 1.3220998 1.0540580 1.6165996
#&gt; 8   200 1.3693801 1.0753561 1.6810470
#&gt; 9   225 1.4101055 1.0937013 1.7337627
#&gt; 10  250 1.4457921 1.1097768 1.7799561
#&gt; 11  275 1.4774927 1.1274338 1.8209899
#&gt; 12  300 1.5059668 1.1487252 1.8578474</div><div class='input'><span class='co'>##Obtain the 'fit' the middle, uppper and lower quantiles for the dose-efficacy curve</span>
<span class='co'>## at all dose levels using an efficacy sample, the 'EffFlexi' efficacy model and the data</span>
<span class='co'>## data must be from 'DataDual' class</span>
<span class='va'>data</span><span class='op'>&lt;-</span><span class='fu'><a href='DataDual.html'>DataDual</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>300</span>,<span class='fl'>250</span>,<span class='fl'>150</span><span class='op'>)</span>,
               y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
               w<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span><span class='op'>)</span>,
               doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span>,
               placebo<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'><span class='co'>## model must be from 'ModelEff' e.g using 'Effloglog' class</span>
<span class='va'>Effmodel</span><span class='op'>&lt;-</span> <span class='fu'><a href='EffFlexi.html'>EffFlexi</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>, <span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,
                    sigma2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0.1</span>,b<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>,sigma2betaW<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>20</span>,b<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span>,smooth<span class='op'>=</span><span class='st'>"RW2"</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>

<span class='co'>## samples must be from 'Samples' class (object slot in fit)</span>
<span class='va'>options</span><span class='op'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>100</span>,step<span class='op'>=</span><span class='fl'>2</span>,samples<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='va'>Effsamples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>data</span>,model<span class='op'>=</span><span class='va'>Effmodel</span>,options<span class='op'>=</span><span class='va'>options</span><span class='op'>)</span>
<span class='fu'>fit</span><span class='op'>(</span>object<span class='op'>=</span><span class='va'>Effsamples</span>, model<span class='op'>=</span><span class='va'>Effmodel</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    dose    middle      lower     upper
#&gt; 1    25 0.7046135  0.6894978 0.7126155
#&gt; 2    50 0.4421001  0.4195110 0.4709683
#&gt; 3    75 0.5938914  0.5397799 0.6348434
#&gt; 4   100 0.6663309 -2.0389402 3.0755831
#&gt; 5   125 0.6698369 -1.7825062 2.8047381
#&gt; 6   150 0.5368523  0.5223029 0.5991312
#&gt; 7   175 0.8831515 -1.7034766 4.0917201
#&gt; 8   200 1.1976416 -2.1248002 4.8165433
#&gt; 9   225 1.4211890 -1.6943591 4.9502433
#&gt; 10  250 1.7390411 -1.2297397 5.0856861
#&gt; 11  275 2.1004783 -1.1036913 5.0479862
#&gt; 12  300 2.4972156  2.4492301 2.5092675</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Giuseppe Palermo, Thomas Jaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


