<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>This is a methods to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the DualResponsesSamplesDesign where DLEmodel
used are of
ModelTox class object and efficacy model used are of
ModelEff
class object (special case is EffFlexi class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process — simulate,DualResponsesSamplesDesign-method • crmPack</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="This is a methods to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the DualResponsesSamplesDesign where DLEmodel
used are of
ModelTox class object and efficacy model used are of
ModelEff
class object (special case is EffFlexi class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process — simulate,DualResponsesSamplesDesign-method" />
<meta property="og:description" content="This is a methods to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the DualResponsesSamplesDesign where DLEmodel
used are of
ModelTox class object and efficacy model used are of
ModelEff
class object (special case is EffFlexi class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crmPack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rolling-crm.html">Rolling CRM Example</a>
    </li>
    <li>
      <a href="../articles/simulations.html">Simulation study example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start_releases -->
<li class="dropdown">
	<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
Other releases
<span class="caret"></span></a><ul class="dropdown-menu" role="menu">
   <li><a href="../../index.html">latest</a></li>
   <li><a href="../..//index.html"></a></li>
</ul></li>
<!-- end_releases -->
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>This is a methods to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the <code><a href='DualResponsesSamplesDesign-class.html'>DualResponsesSamplesDesign</a></code> where DLEmodel
used are of
<code><a href='ModelTox-class.html'>ModelTox</a></code> class object and efficacy model used are of
<code><a href='ModelEff-class.html'>ModelEff</a></code>
class object (special case is <code><a href='EffFlexi-class.html'>EffFlexi</a></code> class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process</h1>
    <small class="dont-index">Source: <a href='https://github.com/roche/crmPack/blob/master/R/Design-methods.R'><code>R/Design-methods.R</code></a></small>
    <div class="hidden name"><code>simulate-DualResponsesSamplesDesign-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a methods to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the <code><a href='DualResponsesSamplesDesign-class.html'>DualResponsesSamplesDesign</a></code> where DLEmodel
used are of
<code><a href='ModelTox-class.html'>ModelTox</a></code> class object and efficacy model used are of
<code><a href='ModelEff-class.html'>ModelEff</a></code>
class object (special case is <code><a href='EffFlexi-class.html'>EffFlexi</a></code> class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for DualResponsesSamplesDesign</span>
<span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  nsim <span class='op'>=</span> <span class='fl'>1L</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>trueDLE</span>,
  <span class='va'>trueEff</span>,
  trueNu <span class='op'>=</span> <span class='cn'>NULL</span>,
  trueSigma2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  trueSigma2betaW <span class='op'>=</span> <span class='cn'>NULL</span>,
  args <span class='op'>=</span> <span class='cn'>NULL</span>,
  firstSeparate <span class='op'>=</span> <span class='cn'>FALSE</span>,
  mcmcOptions <span class='op'>=</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span><span class='op'>)</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  nCores <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>the <code><a href='DualResponsesSamplesDesign-class.html'>DualResponsesSamplesDesign</a></code> object we want to
simulate the data from</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>the number of simulations (default :1)</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>see <code><a href='setSeed.html'>setSeed</a></code></p></td>
    </tr>
    <tr>
      <th>trueDLE</th>
      <td><p>a function which takes as input a dose (vector) and returns the true probability
(vector) of the occurrence of a DLE. Additional arguments can be supplied in <code>args</code>.</p></td>
    </tr>
    <tr>
      <th>trueEff</th>
      <td><p>a function which takes as input a dose (vector) and returns the expected
efficacy responses (vector). Additional arguments can be supplied in <code>args</code>.</p></td>
    </tr>
    <tr>
      <th>trueNu</th>
      <td><p>(not with code<a href='EffFlexi-class.html'>EffFlexi</a>) the precision, the inverse of the
variance of the efficacy responses</p></td>
    </tr>
    <tr>
      <th>trueSigma2</th>
      <td><p>(only with code<a href='EffFlexi-class.html'>EffFlexi</a>) the true variance of the efficacy
responses which must be a single positive scalar.</p></td>
    </tr>
    <tr>
      <th>trueSigma2betaW</th>
      <td><p>(only with code<a href='EffFlexi-class.html'>EffFlexi</a>) the true variance for the
random walk model used for smoothing. This must be a single positive scalar.</p></td>
    </tr>
    <tr>
      <th>args</th>
      <td><p>data frame with arguments for the <code>trueDLE</code> and
<code>trueEff</code> function. The column names correspond to the argument
names, the rows to the values of the arguments. The rows are appropriately
recycled in the <code>nsim</code> simulations.</p></td>
    </tr>
    <tr>
      <th>firstSeparate</th>
      <td><p>enroll the first patient separately from the rest of
the cohort? (not default) If yes, the cohort will be closed if a DLT occurs
in this patient.</p></td>
    </tr>
    <tr>
      <th>mcmcOptions</th>
      <td><p>object of class <code><a href='McmcOptions-class.html'>McmcOptions</a></code>,
giving the MCMC options for each evaluation in the trial. By default,
the standard options are used</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>should the simulation runs be parallelized across the
clusters of the computer? (not default)</p></td>
    </tr>
    <tr>
      <th>nCores</th>
      <td><p>how many cores should be used for parallel computing?
Defaults to the number of cores on the machine, maximum 5.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code><a href='PseudoDualSimulations-class.html'>PseudoDualSimulations</a></code> or
<code><a href='PseudoDualFlexiSimulations-class.html'>PseudoDualFlexiSimulations</a></code></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'>##Simulate dose-escalation procedure based on DLE and efficacy responses where DLE </span></span>
<span class='r-in'><span class='co'>## and efficacy samples are used</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DataDual-class.html'>DataDual</a></span><span class='op'>(</span>doseGrid<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span><span class='op'>)</span>,placebo<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##First for the DLE model </span></span>
<span class='r-in'><span class='co'>##The DLE model must be of 'ModelTox' (e.g 'LogisticIndepBeta') class </span></span>
<span class='r-in'><span class='va'>DLEmodel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span><span class='op'>(</span>binDLE<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.05</span>,<span class='fl'>1.8</span><span class='op'>)</span>,</span>
<span class='r-in'>                              DLEweights<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>,</span>
<span class='r-in'>                              DLEdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>                              data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##The efficacy model of 'ModelEff' (e.g 'Effloglog') class </span></span>
<span class='r-in'><span class='va'>Effmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='Effloglog.html'>Effloglog</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>,<span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>                    nu<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>,b<span class='op'>=</span><span class='fl'>0.025</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>data</span>,c<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##The escalation rule using the 'NextBestMaxGainSamples' class</span></span>
<span class='r-in'><span class='va'>mynextbest</span><span class='op'>&lt;-</span><span class='fu'><a href='NextBestMaxGainSamples.html'>NextBestMaxGainSamples</a></span><span class='op'>(</span>DLEDuringTrialtarget<span class='op'>=</span><span class='fl'>0.35</span>,</span>
<span class='r-in'>                                   DLEEndOfTrialtarget<span class='op'>=</span><span class='fl'>0.3</span>,</span>
<span class='r-in'>                                   TDderive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>TDsamples</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>                                     <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>TDsamples</span>,prob<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>}</span>,</span>
<span class='r-in'>                                   Gstarderive<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>Gstarsamples</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>                                     <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Gstarsamples</span>,prob<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##The increments (see Increments class examples) </span></span>
<span class='r-in'><span class='co'>## 200% allowable increase for dose below 300 and 200% increase for dose above 300</span></span>
<span class='r-in'><span class='va'>myIncrements</span><span class='op'>&lt;-</span><span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span><span class='op'>(</span>intervals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>                                 increments<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##cohort size of 3</span></span>
<span class='r-in'><span class='va'>mySize</span><span class='op'>&lt;-</span><span class='fu'><a href='CohortSizeConst.html'>CohortSizeConst</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Stop only when 10 subjects are treated (only for illustration such a low </span></span>
<span class='r-in'><span class='co'>##sample size)</span></span>
<span class='r-in'><span class='va'>myStopping</span> <span class='op'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span><span class='op'>(</span>nPatients<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Now specified the design with all the above information and starting with </span></span>
<span class='r-in'><span class='co'>##a dose of 25</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Specified the design </span></span>
<span class='r-in'><span class='va'>design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DualResponsesSamplesDesign.html'>DualResponsesSamplesDesign</a></span><span class='op'>(</span>nextBest<span class='op'>=</span><span class='va'>mynextbest</span>,</span>
<span class='r-in'>                                     cohortSize<span class='op'>=</span><span class='va'>mySize</span>,</span>
<span class='r-in'>                                     startingDose<span class='op'>=</span><span class='fl'>25</span>,</span>
<span class='r-in'>                                     model<span class='op'>=</span><span class='va'>DLEmodel</span>,</span>
<span class='r-in'>                                     Effmodel<span class='op'>=</span><span class='va'>Effmodel</span>,</span>
<span class='r-in'>                                     data<span class='op'>=</span><span class='va'>data</span>,</span>
<span class='r-in'>                                     stopping<span class='op'>=</span><span class='va'>myStopping</span>,</span>
<span class='r-in'>                                     increments<span class='op'>=</span><span class='va'>myIncrements</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##specified the true DLE and efficacy curve</span></span>
<span class='r-in'><span class='va'>myTruthDLE</span><span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>{</span> <span class='va'>DLEmodel</span><span class='op'>@</span><span class='va'>prob</span><span class='op'>(</span><span class='va'>dose</span>, phi1<span class='op'>=</span><span class='op'>-</span><span class='fl'>53.66584</span>, phi2<span class='op'>=</span><span class='fl'>10.50499</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>myTruthEff</span><span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>{</span><span class='va'>Effmodel</span><span class='op'>@</span><span class='va'>ExpEff</span><span class='op'>(</span><span class='va'>dose</span>,theta1<span class='op'>=</span><span class='op'>-</span><span class='fl'>4.818429</span>,theta2<span class='op'>=</span><span class='fl'>3.653058</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'><span class='co'>##The true gain curve can also be seen</span></span>
<span class='r-in'><span class='va'>myTruthGain</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>{</span><span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'>myTruthEff</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='op'>(</span><span class='fu'>myTruthDLE</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'>myTruthDLE</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##simulate the trial for 10 times involving samples</span></span>
<span class='r-in'><span class='co'>##for illustration purpose we use 10 burn-ins to generate 50 samples</span></span>
<span class='r-in'><span class='va'>options</span><span class='op'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span><span class='op'>(</span>burnin<span class='op'>=</span><span class='fl'>10</span>,step<span class='op'>=</span><span class='fl'>1</span>,samples<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##For illustration purpose only 1 simulations are produced (nsim=1). </span></span>
<span class='r-in'><span class='va'>mySim</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>design</span>,</span>
<span class='r-in'>                 args<span class='op'>=</span><span class='cn'>NULL</span>,</span>
<span class='r-in'>                 trueDLE<span class='op'>=</span><span class='va'>myTruthDLE</span>,</span>
<span class='r-in'>                 trueEff<span class='op'>=</span><span class='va'>myTruthEff</span>,</span>
<span class='r-in'>                 trueNu<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>0.025</span>,</span>
<span class='r-in'>                 nsim<span class='op'>=</span><span class='fl'>1</span>,</span>
<span class='r-in'>                 mcmcOptions<span class='op'>=</span><span class='va'>options</span>,</span>
<span class='r-in'>                 seed<span class='op'>=</span><span class='fl'>819</span>,</span>
<span class='r-in'>                 parallel<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Simulate dose-escalation procedure based on DLE and efficacy responses where DLE </span></span>
<span class='r-in'><span class='co'>## and efficacy samples are used</span></span>
<span class='r-in'><span class='co'>## when the efficacy model is of 'EffFlexi' class</span></span>
<span class='r-in'><span class='va'>Effmodel</span><span class='op'>&lt;-</span> <span class='fu'><a href='EffFlexi.html'>EffFlexi</a></span><span class='op'>(</span>Eff<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.223</span>, <span class='fl'>2.513</span><span class='op'>)</span>,Effdose<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>,<span class='fl'>300</span><span class='op'>)</span>,</span>
<span class='r-in'>                    sigma2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0.1</span>,b<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>,sigma2betaW<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>20</span>,b<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span>,smooth<span class='op'>=</span><span class='st'>"RW2"</span>,data<span class='op'>=</span><span class='va'>data</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>##Specified the design </span></span>
<span class='r-in'><span class='va'>design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='DualResponsesSamplesDesign.html'>DualResponsesSamplesDesign</a></span><span class='op'>(</span>nextBest<span class='op'>=</span><span class='va'>mynextbest</span>,</span>
<span class='r-in'>                                     cohortSize<span class='op'>=</span><span class='va'>mySize</span>,</span>
<span class='r-in'>                                     startingDose<span class='op'>=</span><span class='fl'>25</span>,</span>
<span class='r-in'>                                     model<span class='op'>=</span><span class='va'>DLEmodel</span>,</span>
<span class='r-in'>                                     Effmodel<span class='op'>=</span><span class='va'>Effmodel</span>,</span>
<span class='r-in'>                                     data<span class='op'>=</span><span class='va'>data</span>,</span>
<span class='r-in'>                                     stopping<span class='op'>=</span><span class='va'>myStopping</span>,</span>
<span class='r-in'>                                     increments<span class='op'>=</span><span class='va'>myIncrements</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##specified the true DLE curve and the true expected efficacy values at all dose levels</span></span>
<span class='r-in'><span class='va'>myTruthDLE</span><span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>dose</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>{</span> <span class='va'>DLEmodel</span><span class='op'>@</span><span class='va'>prob</span><span class='op'>(</span><span class='va'>dose</span>, phi1<span class='op'>=</span><span class='op'>-</span><span class='fl'>53.66584</span>, phi2<span class='op'>=</span><span class='fl'>10.50499</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>myTruthEff</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5478867</span>, <span class='fl'>0.1645417</span>,  <span class='fl'>0.5248031</span>,  <span class='fl'>0.7604467</span>,  </span>
<span class='r-in'>               <span class='fl'>0.9333009</span>  ,<span class='fl'>1.0687031</span>,  <span class='fl'>1.1793942</span> , <span class='fl'>1.2726408</span> , </span>
<span class='r-in'>               <span class='fl'>1.3529598</span> , <span class='fl'>1.4233411</span> , <span class='fl'>1.4858613</span> , <span class='fl'>1.5420182</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##The true gain curve can also be seen</span></span>
<span class='r-in'><span class='va'>d1</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>@</span><span class='va'>doseGrid</span></span>
<span class='r-in'><span class='va'>myTruthGain</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>myTruthEff</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='op'>(</span><span class='fu'>myTruthDLE</span><span class='op'>(</span><span class='va'>d1</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'>myTruthDLE</span><span class='op'>(</span><span class='va'>d1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>mySim</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span>object<span class='op'>=</span><span class='va'>design</span>,</span>
<span class='r-in'>                args<span class='op'>=</span><span class='cn'>NULL</span>,</span>
<span class='r-in'>                trueDLE<span class='op'>=</span><span class='va'>myTruthDLE</span>,</span>
<span class='r-in'>                trueEff<span class='op'>=</span><span class='va'>myTruthEff</span>,</span>
<span class='r-in'>                trueSigma2<span class='op'>=</span><span class='fl'>0.025</span>,</span>
<span class='r-in'>                trueSigma2betaW<span class='op'>=</span><span class='fl'>1</span>,</span>
<span class='r-in'>                mcmcOptions<span class='op'>=</span><span class='va'>options</span>,</span>
<span class='r-in'>                nsim<span class='op'>=</span><span class='fl'>1</span>,</span>
<span class='r-in'>                seed<span class='op'>=</span><span class='fl'>819</span>,</span>
<span class='r-in'>                parallel<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Giuseppe Palermo, Thomas Jaki, Jiawen Zhu, Ziwei Liao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


