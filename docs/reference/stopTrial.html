<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stop the trial? — stopTrial • crmPack</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Stop the trial? — stopTrial" />

<meta property="og:description" content="This function returns whether to stop the trial." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crmPack</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stop the trial?</h1>
    <small class="dont-index">Source: <a href='https://github.com/roche/crmPack/blob/master/R/Rules-methods.R'><code>R/Rules-methods.R</code></a></small>
    <div class="hidden name"><code>stopTrial.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function returns whether to stop the trial.</p>
    
    </div>

    <pre class="usage"><span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingList,ANY,ANY,ANY,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>, <span class='no'>samples</span>,
  <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingAll,ANY,ANY,ANY,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>, <span class='no'>samples</span>,
  <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingAny,ANY,ANY,ANY,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>, <span class='no'>samples</span>,
  <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingCohortsNearDose,numeric,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingPatientsNearDose,numeric,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingMinCohorts,ANY,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>,
  <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingMinPatients,ANY,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>,
  <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingTargetProb,numeric,Samples,Model,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)


  <span class='co'># S4 method for StoppingMTDdistribution,numeric,Samples,Model,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)


  <span class='co'># S4 method for StoppingTargetBiomarker,numeric,Samples,DualEndpoint,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingHighestDose,numeric,ANY,ANY,Data</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>,
  <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingTDCIRatio,ANY,Samples,ModelTox,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>,
  <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S4 method for StoppingTDCIRatio,ANY,missing,ModelTox,ANY</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>, <span class='no'>dose</span>,
  <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>...</span>)


  <span class='co'># S4 method for StoppingGstarCIRatio,ANY,Samples,ModelTox,DataDual</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>samples</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>TDderive</span>, <span class='no'>Effmodel</span>, <span class='no'>Effsamples</span>, <span class='no'>Gstarderive</span>, <span class='no'>...</span>)


  <span class='co'># S4 method for StoppingGstarCIRatio,ANY,missing,ModelTox,DataDual</span>
<span class='fu'>stopTrial</span>(<span class='no'>stopping</span>,
  <span class='no'>dose</span>, <span class='no'>model</span>, <span class='no'>data</span>, <span class='no'>Effmodel</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>stopping</th>
      <td><p>The rule, an object of class
<code><a href='Stopping-class.html'>Stopping</a></code></p></td>
    </tr>
    <tr>
      <th>dose</th>
      <td><p>the recommended next best dose</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>the <code><a href='Samples-class.html'>Samples</a></code> object</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>The model input, an object of class <code><a href='Model-class.html'>Model</a></code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>The data input, an object of class <code><a href='Data-class.html'>Data</a></code></p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>additional arguments</p></td>
    </tr>
    <tr>
      <th>TDderive</th>
      <td><p>the function which derives from the input, a vector of the posterior samples called 
<code>TDsamples</code> of the dose
which has the probability of the occurrence of DLE equals to either the targetDuringTrial or
targetEndOfTrial, the final next best TDtargetDuringTrial (the dose with probability of the 
occurrence of DLE equals to the targetDuringTrial)and TDtargetEndOfTrial estimate.</p></td>
    </tr>
    <tr>
      <th>Effmodel</th>
      <td><p>the efficacy model of <code><a href='ModelEff-class.html'>ModelEff</a></code> class object</p></td>
    </tr>
    <tr>
      <th>Effsamples</th>
      <td><p>the efficacy samples of <code><a href='Samples-class.html'>Samples</a></code> class object</p></td>
    </tr>
    <tr>
      <th>Gstarderive</th>
      <td><p>the function which derives from the input, a vector of the posterior Gstar (the dose
which gives the maximum gain value) samples 
called <code>Gstarsamples</code>, the final next best Gstar estimate.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>logical value: <code>TRUE</code> if the trial can be stopped, <code>FALSE</code>
otherwise. It should have an attribute <code>message</code> which gives the reason
for the decision.</p>
    
    <h2 class="hasAnchor" id="methods-by-class-"><a class="anchor" href="#methods-by-class-"></a>Methods (by class)</h2>

    <ul>
<li><p><code>stopping = StoppingList,dose = ANY,samples = ANY,model = ANY,data = ANY</code>: Stop based on multiple stopping rules</p></li>
<li><p><code>stopping = StoppingAll,dose = ANY,samples = ANY,model = ANY,data = ANY</code>: Stop based on fulfillment of all multiple stopping
rules</p></li>
<li><p><code>stopping = StoppingAny,dose = ANY,samples = ANY,model = ANY,data = ANY</code>: Stop based on fulfillment of any stopping rule</p></li>
<li><p><code>stopping = StoppingCohortsNearDose,dose = numeric,samples = ANY,model = ANY,data = Data</code>: Stop based on number of cohorts near to next best dose</p></li>
<li><p><code>stopping = StoppingPatientsNearDose,dose = numeric,samples = ANY,model = ANY,data = Data</code>: Stop based on number of patients near to next best
dose</p></li>
<li><p><code>stopping = StoppingMinCohorts,dose = ANY,samples = ANY,model = ANY,data = Data</code>: Stop based on minimum number of cohorts</p></li>
<li><p><code>stopping = StoppingMinPatients,dose = ANY,samples = ANY,model = ANY,data = Data</code>: Stop based on minimum number of patients</p></li>
<li><p><code>stopping = StoppingTargetProb,dose = numeric,samples = Samples,model = Model,data = ANY</code>: Stop based on probability of target tox interval</p></li>
<li><p><code>stopping = StoppingMTDdistribution,dose = numeric,samples = Samples,model = Model,data = ANY</code>: Stop based on MTD distribution</p></li>
<li><p><code>stopping = StoppingTargetBiomarker,dose = numeric,samples = Samples,model = DualEndpoint,data = ANY</code>: Stop based on probability of targeting biomarker</p></li>
<li><p><code>stopping = StoppingHighestDose,dose = numeric,samples = ANY,model = ANY,data = Data</code>: Stop when the highest dose is reached</p></li>
<li><p><code>stopping = StoppingTDCIRatio,dose = ANY,samples = Samples,model = ModelTox,data = ANY</code>: Stop based on 'StoppingTDCIRatio' class when 
reaching the target ratio of the upper to the lower 95<!-- % credibility  -->
interval of the estimate (TDtargetEndOfTrial). This is a stopping rule which incorporate only 
DLE responses and DLE samples are given</p></li>
<li><p><code>stopping = StoppingTDCIRatio,dose = ANY,samples = missing,model = ModelTox,data = ANY</code>: Stop based on 'StoppingTDCIRatio' class
when reaching the target ratio of the upper to the lower 95<!-- % credibility  -->
interval of the estimate (TDtargetEndOfTrial). This is a stopping rule which incorporate only 
DLE responses and no DLE samples are involved</p></li>
<li><p><code>stopping = StoppingGstarCIRatio,dose = ANY,samples = Samples,model = ModelTox,data = DataDual</code>: Stop based on reaching the target ratio of the upper to the lower 95<!-- % credibility  -->
interval of the estimate (the minimum of Gstar and TDtargetEndOfTrial). This is a stopping rule which 
incorporate DLE and efficacy responses and DLE and efficacy samples are also used.</p></li>
<li><p><code>stopping = StoppingGstarCIRatio,dose = ANY,samples = missing,model = ModelTox,data = DataDual</code>: Stop based on reaching the target ratio of the upper to the lower 95<!-- % credibility  -->
interval of the estimate (the minimum of Gstar and TDtargetEndOfTrial). This is a stopping rule which 
incorporate DLE and efficacy responses without DLE and efficacy samples involved.</p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Example of combining stopping rules with '&amp;' and/or '|' operators</span>

<span class='no'>myStopping1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span>(<span class='kw'>nCohorts</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>myStopping2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                                  <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)
<span class='no'>myStopping3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span>(<span class='kw'>nPatients</span><span class='kw'>=</span><span class='fl'>20</span>)

<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> (<span class='no'>myStopping1</span> <span class='kw'>&amp;</span> <span class='no'>myStopping2</span>) <span class='kw'>|</span> <span class='no'>myStopping3</span>





<span class='co'># Create some data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rules</span>
<span class='no'>myStopping1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span>(<span class='kw'>nCohorts</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>myStopping2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                                  <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)
<span class='no'>myStopping3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span>(<span class='kw'>nPatients</span><span class='kw'>=</span><span class='fl'>20</span>)

<span class='co'># Create a list of stopping rules (of class 'StoppingList') which will then be</span>
<span class='co'># summarized (in this specific example) with the 'any' function, meaning that the study </span>
<span class='co'># would be stopped if 'any' of the single stopping rules is TRUE.</span>
<span class='no'>mystopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingList.html'>StoppingList</a></span>(<span class='kw'>stopList</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='no'>myStopping1</span>,<span class='no'>myStopping2</span>,<span class='no'>myStopping3</span>),
                           <span class='kw'>summary</span><span class='kw'>=</span><span class='no'>any</span>)

<span class='co'># Evaluate if to stop the Trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>, <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; attr(,"message")[[1]]
#&gt; attr(,"message")[[1]][[1]]
#&gt; [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 3"
#&gt; 
#&gt; attr(,"message")[[1]][[2]]
#&gt; [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"
#&gt; 
#&gt; 
#&gt; attr(,"message")[[2]]
#&gt; [1] "Number of patients is 8 and thus below the prespecified minimum number 20"
#&gt; </div><div class='input'>



<span class='co'># Create some data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rules</span>
<span class='no'>myStopping1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span>(<span class='kw'>nCohorts</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>myStopping2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                                  <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)
<span class='no'>myStopping3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span>(<span class='kw'>nPatients</span><span class='kw'>=</span><span class='fl'>20</span>)

<span class='co'># Combine the stopping rules, obtaining (in this specific example) a list of stopping </span>
<span class='co'># rules of class 'StoppingAll'</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> (<span class='no'>myStopping1</span> <span class='kw'>|</span> <span class='no'>myStopping2</span>) <span class='kw'>&amp;</span> <span class='no'>myStopping3</span>

<span class='co'># Evaluate if to stop the Trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>, <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; attr(,"message")[[1]]
#&gt; attr(,"message")[[1]][[1]]
#&gt; [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 3"
#&gt; 
#&gt; attr(,"message")[[1]][[2]]
#&gt; [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"
#&gt; 
#&gt; 
#&gt; attr(,"message")[[2]]
#&gt; [1] "Number of patients is 8 and thus below the prespecified minimum number 20"
#&gt; </div><div class='input'>



<span class='co'># Create some data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rules</span>
<span class='no'>myStopping1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span>(<span class='kw'>nCohorts</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>myStopping2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                                  <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)
<span class='no'>myStopping3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span>(<span class='kw'>nPatients</span><span class='kw'>=</span><span class='fl'>20</span>)

<span class='co'># Combine the stopping rules, obtaining (in this specific example) a list of stopping </span>
<span class='co'># rules of class 'StoppingAny'</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> (<span class='no'>myStopping1</span> <span class='kw'>|</span> <span class='no'>myStopping2</span>) <span class='kw'>|</span> <span class='no'>myStopping3</span>

<span class='co'># Evaluate if to stop the Trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>, <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] TRUE
#&gt; attr(,"message")
#&gt; attr(,"message")[[1]]
#&gt; [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 3"
#&gt; 
#&gt; attr(,"message")[[2]]
#&gt; [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"
#&gt; 
#&gt; attr(,"message")[[3]]
#&gt; [1] "Number of patients is 8 and thus below the prespecified minimum number 20"
#&gt; </div><div class='input'>



<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if at least 3 </span>
<span class='co'># cohorts were already dosed within 1 +/- 0.2 of the next best dose</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingCohortsNearDose.html'>StoppingCohortsNearDose</a></span>(<span class='kw'>nCohorts</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                                      <span class='kw'>percentage</span> <span class='kw'>=</span> <span class='fl'>0.2</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; [1] "0 cohorts lie within 0.2% of the next best dose 16. This is below the required 3 cohorts"</div><div class='input'>

<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if at least 9 </span>
<span class='co'># patients were already dosed within 1 +/- 0.2 of the next best dose</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingPatientsNearDose.html'>StoppingPatientsNearDose</a></span>(<span class='kw'>nPatients</span> <span class='kw'>=</span> <span class='fl'>9</span>,
                                       <span class='kw'>percentage</span> <span class='kw'>=</span> <span class='fl'>0.2</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; [1] "0 patients lie within 0.2% of the next best dose 16. This is below the required 9 patients"</div><div class='input'>

<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if at least 6 </span>
<span class='co'># cohorts were already dosed </span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinCohorts.html'>StoppingMinCohorts</a></span>(<span class='kw'>nCohorts</span> <span class='kw'>=</span> <span class='fl'>6</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] TRUE
#&gt; attr(,"message")
#&gt; [1] "Number of cohorts is 6 and thus reached the prespecified minimum number 6"</div><div class='input'>

<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if at least 20 </span>
<span class='co'># patients were already dosed </span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMinPatients.html'>StoppingMinPatients</a></span>(<span class='kw'>nPatients</span> <span class='kw'>=</span> <span class='fl'>20</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; [1] "Number of patients is 8 and thus below the prespecified minimum number 20"</div><div class='input'>

<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if there is at least </span>
<span class='co'># 0.5 posterior probability that [0.2 =&lt; Prob(DLT | next-best-dose) &lt;= 0.35] </span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                                 <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,
          <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; [1] "Probability for target toxicity is 34 % for dose 16 and thus below the required 50 %"</div><div class='input'>

<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if there is at least </span>
<span class='co'># 0.9 probability that MTD &gt; 0.5*next_best_dose. Here MTD is defined as the dose for </span>
<span class='co'># which prob(DLE)=0.33</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingMTDdistribution.html'>StoppingMTDdistribution</a></span>(<span class='kw'>target</span> <span class='kw'>=</span> <span class='fl'>0.33</span>,
                                      <span class='kw'>thresh</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
                                      <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,
          <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] TRUE
#&gt; attr(,"message")
#&gt; [1] "Probability of MTD above 50 % of current dose 16 is 96 % and thus above the required 90 %"</div><div class='input'>

<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='DataDual.html'>DataDual</a></span>(
  <span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>,
      <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>50</span>),
  <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>,
      <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>),
  <span class='kw'>w</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.31</span>, <span class='fl'>0.42</span>, <span class='fl'>0.59</span>, <span class='fl'>0.45</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>, <span class='fl'>0.55</span>, <span class='fl'>0.6</span>,
      <span class='fl'>0.52</span>, <span class='fl'>0.54</span>, <span class='fl'>0.56</span>, <span class='fl'>0.43</span>, <span class='fl'>0.41</span>, <span class='fl'>0.39</span>, <span class='fl'>0.34</span>, <span class='fl'>0.38</span>, <span class='fl'>0.21</span>),
  <span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
             <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='co'># Initialize the Dual-Endpoint model (in this case RW1)</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='DualEndpointRW.html'>DualEndpointRW</a></span>(<span class='kw'>mu</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>),
                        <span class='kw'>Sigma</span> <span class='kw'>=</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                        <span class='kw'>sigma2betaW</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
                        <span class='kw'>sigma2W</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0.1</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='fl'>0.1</span>),
                        <span class='kw'>rho</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='fl'>1</span>),
                        <span class='kw'>smooth</span> <span class='kw'>=</span> <span class='st'>"RW1"</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>500</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># In this case target a dose achieving at least 0.9 of maximum biomarker level (efficacy)</span>
<span class='co'># and with a probability below 0.25 that prob(DLT)&gt;0.35 (safety)</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestDualEndpoint.html'>NextBestDualEndpoint</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.9</span>, <span class='fl'>1</span>),
                                   <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                                   <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,
                               <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,
                               <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if if there is at </span>
<span class='co'># least 0.5 posterior probability that the biomarker (efficacy) is within the </span>
<span class='co'># biomarker target range of [0.9, 1.0] (relative to the maximum for the biomarker). </span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetBiomarker.html'>StoppingTargetBiomarker</a></span>(<span class='kw'>target</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.9</span>, <span class='fl'>1</span>),
                                      <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='co'># Evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,
          <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; [1] "Probability for target biomarker is 10 % for dose 6 and thus below the required 50 %"</div><div class='input'>
<span class='co'># Create the data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>40</span>, <span class='fl'>40</span>,
                 <span class='fl'>80</span>, <span class='fl'>80</span>, <span class='fl'>80</span>),
             <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>),
             <span class='kw'>cohort</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>6</span>, <span class='fl'>6</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>7</span>, <span class='fl'>8</span>, <span class='fl'>8</span>, <span class='fl'>8</span>),
             <span class='kw'>doseGrid</span><span class='kw'>=</span>
               <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>1.5</span>, <span class='fl'>3</span>, <span class='fl'>6</span>,
                 <span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='input'>
<span class='co'># Initialize the CRM model used to model the data</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='LogisticLogNormal.html'>LogisticLogNormal</a></span>(<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.85</span>, <span class='fl'>1</span>),
                           <span class='kw'>cov</span><span class='kw'>=</span>
                             <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.5</span>, -<span class='fl'>0.5</span>, <span class='fl'>1</span>),
                                    <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
                           <span class='kw'>refDose</span><span class='kw'>=</span><span class='fl'>56</span>)

<span class='co'># Set-up some MCMC parameters and generate samples from the posterior</span>
<span class='no'>options</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>,
                       <span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,
                       <span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>2000</span>)
<span class='fu'>set.seed</span>(<span class='fl'>94</span>)
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>, <span class='no'>model</span>, <span class='no'>options</span>)

<span class='co'># Define the rule for dose increments and calculate the maximum dose allowed</span>
<span class='no'>myIncrements</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='IncrementsRelative.html'>IncrementsRelative</a></span>(<span class='kw'>intervals</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>20</span>),
                                   <span class='kw'>increments</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.33</span>))
<span class='no'>nextMaxDose</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='maxDose.html'>maxDose</a></span>(<span class='no'>myIncrements</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the rule which will be used to select the next best dose</span>
<span class='co'># based on the class 'NextBestNCRM'</span>
<span class='no'>myNextBest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='NextBestNCRM.html'>NextBestNCRM</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                           <span class='kw'>overdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.35</span>, <span class='fl'>1</span>),
                           <span class='kw'>maxOverdoseProb</span><span class='kw'>=</span><span class='fl'>0.25</span>)

<span class='co'># Calculate the next best dose</span>
<span class='no'>doseRecommendation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>myNextBest</span>,
                               <span class='kw'>doselimit</span><span class='kw'>=</span><span class='no'>nextMaxDose</span>,
                               <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'># Define the stopping rule such that the study would be stopped if there is at least </span>
<span class='co'># 0.5 posterior probability that [0.2 =&lt; Prob(DLT | next-best-dose) &lt;= 0.35] </span>
<span class='no'>stopTarget</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.35</span>),
                                 <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)

<span class='co'>## now use the StoppingHighestDose rule:</span>
<span class='no'>stopHigh</span> <span class='kw'>&lt;-</span>
  <span class='fu'><a href='StoppingHighestDose.html'>StoppingHighestDose</a></span>() <span class='kw'>&amp;</span>
  <span class='fu'><a href='StoppingPatientsNearDose.html'>StoppingPatientsNearDose</a></span>(<span class='kw'>nPatients</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>percentage</span><span class='kw'>=</span><span class='fl'>0</span>) <span class='kw'>&amp;</span>
  <span class='fu'><a href='StoppingTargetProb.html'>StoppingTargetProb</a></span>(<span class='kw'>target</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0.2</span>),
                     <span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)

<span class='co'>## and combine everything:</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='no'>stopTarget</span> <span class='kw'>|</span> <span class='no'>stopHigh</span>

<span class='co'># Then evaluate if to stop the trial</span>
<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>doseRecommendation</span>$<span class='no'>value</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,
          <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; attr(,"message")[[1]]
#&gt; [1] "Probability for target toxicity is 49 % for dose 62 and thus below the required 50 %"
#&gt; 
#&gt; attr(,"message")[[2]]
#&gt; attr(,"message")[[2]][[1]]
#&gt; [1] "Next best dose is 62 and thus not the highest dose"
#&gt; 
#&gt; attr(,"message")[[2]][[2]]
#&gt; [1] "0 patients lie within 0% of the next best dose 62. This is below the required 3 patients"
#&gt; 
#&gt; attr(,"message")[[2]][[3]]
#&gt; [1] "Probability for target toxicity is 28 % for dose 62 and thus below the required 50 %"
#&gt; 
#&gt; </div><div class='input'>


<span class='co'>##define the stopping rules based on the 'StoppingTDCIRatio' class</span>
<span class='co'>##Using only DLE responses with samples</span>
<span class='co'>## we need a data object with doses &gt;= 1:</span>
<span class='no'>data</span><span class='kw'>&lt;-</span><span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>150</span>,<span class='fl'>200</span>,<span class='fl'>225</span>,<span class='fl'>300</span>),
           <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>),
           <span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>25</span>,<span class='kw'>to</span><span class='kw'>=</span><span class='fl'>300</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>25</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='co'>##model can be specified of 'Model' or 'ModelTox' class</span>
<span class='co'>##For example, the 'logisticIndepBeta' class model</span>
<span class='no'>model</span><span class='kw'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span>(<span class='kw'>binDLE</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.05</span>,<span class='fl'>1.8</span>),<span class='kw'>DLEweights</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>3</span>,<span class='fl'>3</span>),<span class='kw'>DLEdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)
<span class='co'>##define MCMC options</span>
<span class='co'>##for illustration purpose we use 10 burn-in and generate 50 samples</span>
<span class='no'>options</span><span class='kw'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>50</span>)
<span class='co'>##samples of 'Samples' class</span>
<span class='no'>samples</span><span class='kw'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>,<span class='no'>model</span>,<span class='no'>options</span>)
<span class='co'>##define the 'StoppingTDCIRatio' class</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTDCIRatio.html'>StoppingTDCIRatio</a></span>(<span class='kw'>targetRatio</span><span class='kw'>=</span><span class='fl'>5</span>,
                                       <span class='kw'>targetEndOfTrial</span><span class='kw'>=</span><span class='fl'>0.3</span>)
<span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span>
<span class='no'>tdNextBest</span><span class='kw'>&lt;-</span><span class='fu'><a href='NextBestTDsamples.html'>NextBestTDsamples</a></span>(<span class='kw'>targetDuringTrial</span><span class='kw'>=</span><span class='fl'>0.35</span>,<span class='kw'>targetEndOfTrial</span><span class='kw'>=</span><span class='fl'>0.3</span>,
                              <span class='kw'>derive</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>TDsamples</span>){<span class='fu'>quantile</span>(<span class='no'>TDsamples</span>,<span class='kw'>probs</span><span class='kw'>=</span><span class='fl'>0.3</span>)})


<span class='no'>RecommendDose</span><span class='kw'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>tdNextBest</span>,<span class='kw'>doselimit</span><span class='kw'>=</span><span class='fu'>max</span>(<span class='no'>data</span>@<span class='kw'>doseGrid</span>),<span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,
                        <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)
<span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span>
<span class='co'>##use 0.3 as the target proability of DLE at the end of the trial</span>

<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,<span class='kw'>dose</span><span class='kw'>=</span><span class='no'>RecommendDose</span>$<span class='no'>nextdose</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>samples</span>,<span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] TRUE
#&gt; attr(,"message")
#&gt; [1] "Recommended next best dose is NA"</div><div class='input'><span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span>
<span class='co'>##define the stopping rules based on the 'StoppingTDCIRatio' class</span>
<span class='co'>##Using only DLE responses </span>
<span class='co'>## we need a data object with doses &gt;= 1:</span>
<span class='no'>data</span><span class='kw'>&lt;-</span><span class='fu'><a href='Data.html'>Data</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>150</span>,<span class='fl'>200</span>,<span class='fl'>225</span>,<span class='fl'>300</span>),
           <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>),
           <span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>25</span>,<span class='kw'>to</span><span class='kw'>=</span><span class='fl'>300</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>25</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='co'>##model must be of 'ModelTox' class</span>
<span class='co'>##For example, the 'logisticIndepBeta' class model</span>
<span class='no'>model</span><span class='kw'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span>(<span class='kw'>binDLE</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.05</span>,<span class='fl'>1.8</span>),<span class='kw'>DLEweights</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>3</span>,<span class='fl'>3</span>),<span class='kw'>DLEdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)
<span class='co'>##define the 'StoppingTDCIRatio' class</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingTDCIRatio.html'>StoppingTDCIRatio</a></span>(<span class='kw'>targetRatio</span><span class='kw'>=</span><span class='fl'>5</span>,
                                <span class='kw'>targetEndOfTrial</span><span class='kw'>=</span><span class='fl'>0.3</span>)
<span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span>
<span class='no'>tdNextBest</span><span class='kw'>&lt;-</span><span class='fu'><a href='NextBestTD.html'>NextBestTD</a></span>(<span class='kw'>targetDuringTrial</span><span class='kw'>=</span><span class='fl'>0.35</span>,<span class='kw'>targetEndOfTrial</span><span class='kw'>=</span><span class='fl'>0.3</span>)


<span class='no'>RecommendDose</span><span class='kw'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>tdNextBest</span>,<span class='kw'>doselimit</span><span class='kw'>=</span><span class='fu'>max</span>(<span class='no'>data</span>@<span class='kw'>doseGrid</span>),<span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)
<span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span>
<span class='co'>##use 0.3 as the target proability of DLE at the end of the trial</span>

<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,<span class='kw'>dose</span><span class='kw'>=</span><span class='no'>RecommendDose</span>$<span class='no'>nextdose</span>,
          <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"messgae")
#&gt; [1] "95% CI is ( 15.2619 , 173.8695 ), Ratio = 11.3924 is  greater than targetRatio = 5"</div><div class='input'><span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span>
<span class='co'>##define the stopping rules based on the 'StoppingGstarCIRatio' class</span>
<span class='co'>##Using both DLE and efficacy responses</span>
<span class='co'>## we need a data object with doses &gt;= 1:</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span><span class='fu'><a href='DataDual.html'>DataDual</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>300</span>,<span class='fl'>250</span>,<span class='fl'>150</span>),
                <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),
                <span class='kw'>w</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span>),
                <span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span>),
                <span class='kw'>placebo</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='co'>##DLEmodel must be of 'ModelTox' class</span>
<span class='co'>##For example, the 'logisticIndepBeta' class model</span>
<span class='no'>DLEmodel</span><span class='kw'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span>(<span class='kw'>binDLE</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.05</span>,<span class='fl'>1.8</span>),<span class='kw'>DLEweights</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>3</span>,<span class='fl'>3</span>),<span class='kw'>DLEdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'>##Effmodel must be  of 'ModelEff' class</span>
<span class='co'>##For example, the 'Effloglog' class model</span>
<span class='no'>Effmodel</span><span class='kw'>&lt;-</span><span class='fu'><a href='Effloglog.html'>Effloglog</a></span>(<span class='kw'>Eff</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.223</span>,<span class='fl'>2.513</span>),<span class='kw'>Effdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),<span class='kw'>nu</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>0.025</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>,<span class='kw'>c</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='co'>##for illustration purpose we use 10 burn-in and generate 50 samples</span>
<span class='no'>options</span><span class='kw'>&lt;-</span><span class='fu'><a href='McmcOptions.html'>McmcOptions</a></span>(<span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>step</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>samples</span><span class='kw'>=</span><span class='fl'>50</span>)
<span class='co'>##DLE and efficacy samples must be of 'Samples' class</span>
<span class='no'>DLEsamples</span><span class='kw'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>,<span class='no'>DLEmodel</span>,<span class='no'>options</span>)
<span class='no'>Effsamples</span><span class='kw'>&lt;-</span><span class='fu'><a href='mcmc.html'>mcmc</a></span>(<span class='no'>data</span>,<span class='no'>Effmodel</span>,<span class='no'>options</span>)

<span class='co'>##define the 'StoppingGstarCIRatio' class</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingGstarCIRatio.html'>StoppingGstarCIRatio</a></span>(<span class='kw'>targetRatio</span><span class='kw'>=</span><span class='fl'>5</span>,
                                          <span class='kw'>targetEndOfTrial</span><span class='kw'>=</span><span class='fl'>0.3</span>)
<span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span>
<span class='no'>mynextbest</span><span class='kw'>&lt;-</span><span class='fu'><a href='NextBestMaxGainSamples.html'>NextBestMaxGainSamples</a></span>(<span class='kw'>DLEDuringTrialtarget</span><span class='kw'>=</span><span class='fl'>0.35</span>,
                                   <span class='kw'>DLEEndOfTrialtarget</span><span class='kw'>=</span><span class='fl'>0.3</span>,
                                   <span class='kw'>TDderive</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>TDsamples</span>){
                                     <span class='fu'>quantile</span>(<span class='no'>TDsamples</span>,<span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.3</span>)},
                                   <span class='kw'>Gstarderive</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>Gstarsamples</span>){
                                     <span class='fu'>quantile</span>(<span class='no'>Gstarsamples</span>,<span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)})

<span class='no'>RecommendDose</span><span class='kw'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>mynextbest</span>,<span class='kw'>doselimit</span><span class='kw'>=</span><span class='fu'>max</span>(<span class='no'>data</span>@<span class='kw'>doseGrid</span>),<span class='kw'>samples</span><span class='kw'>=</span><span class='no'>DLEsamples</span>,<span class='kw'>model</span><span class='kw'>=</span><span class='no'>DLEmodel</span>,
                        <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>,<span class='kw'>Effmodel</span><span class='kw'>=</span><span class='no'>Effmodel</span>,<span class='kw'>Effsamples</span><span class='kw'>=</span><span class='no'>Effsamples</span>)</div><div class='output co'>#&gt; [1] "Estimated TD 35 = 14.8679719869239  not within dose Grid"
#&gt; [1] "Estimated TD 30 = 9.60973788445752  not within dose Grid"</div><div class='input'><span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span>
<span class='co'>##use 0.3 as the target proability of DLE at the end of the trial </span>

<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,
          <span class='kw'>dose</span><span class='kw'>=</span><span class='no'>RecommendDose</span>$<span class='no'>nextdose</span>,
          <span class='kw'>samples</span><span class='kw'>=</span><span class='no'>DLEsamples</span>,
          <span class='kw'>model</span><span class='kw'>=</span><span class='no'>DLEmodel</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>,
          <span class='kw'>TDderive</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>TDsamples</span>){
            <span class='fu'>quantile</span>(<span class='no'>TDsamples</span>,<span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.3</span>)},
          <span class='kw'>Effmodel</span><span class='kw'>=</span><span class='no'>Effmodel</span>,
          <span class='kw'>Effsamples</span><span class='kw'>=</span><span class='no'>Effsamples</span>,
          <span class='kw'>Gstarderive</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>Gstarsamples</span>){
            <span class='fu'>quantile</span>(<span class='no'>Gstarsamples</span>,<span class='kw'>prob</span><span class='kw'>=</span><span class='fl'>0.5</span>)})</div><div class='output co'>#&gt; [1] TRUE
#&gt; attr(,"message")
#&gt; [1] "Recommended next best dose is NA"</div><div class='input'>
<span class='co'>## RecommendDose$nextdose refers to the next dose obtained in RecommendDose</span>
<span class='co'>##define the stopping rules based on the 'StoppingGstarCIRatio' class</span>
<span class='co'>##Using both DLE and efficacy responses</span>
<span class='co'>## we need a data object with doses &gt;= 1:</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span><span class='fu'><a href='DataDual.html'>DataDual</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>300</span>,<span class='fl'>250</span>,<span class='fl'>150</span>),
                <span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),
                <span class='kw'>w</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span>),
                <span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span>),
                <span class='kw'>placebo</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='co'>##DLEmodel must be of 'ModelTox' class</span>
<span class='co'>##For example, the 'logisticIndepBeta' class model</span>
<span class='no'>DLEmodel</span><span class='kw'>&lt;-</span><span class='fu'><a href='LogisticIndepBeta.html'>LogisticIndepBeta</a></span>(<span class='kw'>binDLE</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.05</span>,<span class='fl'>1.8</span>),<span class='kw'>DLEweights</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>3</span>,<span class='fl'>3</span>),<span class='kw'>DLEdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'>##Effmodel must be  of 'ModelEff' class</span>
<span class='co'>##For example, the 'Effloglog' class model</span>
<span class='no'>Effmodel</span><span class='kw'>&lt;-</span><span class='fu'><a href='Effloglog.html'>Effloglog</a></span>(<span class='kw'>Eff</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.223</span>,<span class='fl'>2.513</span>),<span class='kw'>Effdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),<span class='kw'>nu</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>0.025</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>,<span class='kw'>c</span><span class='kw'>=</span><span class='fl'>0</span>)


<span class='co'>##define the 'StoppingGstarCIRatio' class</span>
<span class='no'>myStopping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='StoppingGstarCIRatio.html'>StoppingGstarCIRatio</a></span>(<span class='kw'>targetRatio</span><span class='kw'>=</span><span class='fl'>5</span>,
                                   <span class='kw'>targetEndOfTrial</span><span class='kw'>=</span><span class='fl'>0.3</span>)
<span class='co'>##Find the next Recommend dose using the nextBest method (plesae refer to nextbest examples)</span>
<span class='no'>mynextbest</span><span class='kw'>&lt;-</span><span class='fu'><a href='NextBestMaxGain.html'>NextBestMaxGain</a></span>(<span class='kw'>DLEDuringTrialtarget</span><span class='kw'>=</span><span class='fl'>0.35</span>,<span class='kw'>DLEEndOfTrialtarget</span><span class='kw'>=</span><span class='fl'>0.3</span>)

<span class='no'>RecommendDose</span><span class='kw'>&lt;-</span><span class='fu'><a href='nextBest.html'>nextBest</a></span>(<span class='no'>mynextbest</span>,<span class='kw'>doselimit</span><span class='kw'>=</span><span class='fu'>max</span>(<span class='no'>data</span>@<span class='kw'>doseGrid</span>),<span class='kw'>model</span><span class='kw'>=</span><span class='no'>DLEmodel</span>,
                        <span class='kw'>Effmodel</span><span class='kw'>=</span><span class='no'>Effmodel</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'>##use 'stopTrial' to determine if the rule has been fulfilled</span>
<span class='co'>##use 0.3 as the target proability of DLE at the end of the trial</span>


<span class='fu'>stopTrial</span>(<span class='kw'>stopping</span><span class='kw'>=</span><span class='no'>myStopping</span>,<span class='kw'>dose</span><span class='kw'>=</span><span class='no'>RecommendDose</span>$<span class='no'>nextdose</span>,<span class='kw'>model</span><span class='kw'>=</span><span class='no'>DLEmodel</span>,
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>, <span class='kw'>Effmodel</span><span class='kw'>=</span><span class='no'>Effmodel</span>)</div><div class='output co'>#&gt; [1] FALSE
#&gt; attr(,"message")
#&gt; [1] "Gstar estimate is 94.942 with 95% CI ( 16.771 , 537.4745 ) and its ratio = 32.0479"                
#&gt; [2] "TDtargetEndOfTrial estimate is  81.4924 with 95% CI ( 24.3435 , 272.804 ) and its ratio= 11.2064"  
#&gt; [3] "TDatrgetEndOfTrial estimate is smaller with ratio = 11.2064 which is  greater than targetRatio = 5"</div><div class='input'>

## RecommendDose$nextdose refers to the next dose obtained in RecommendDose
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#methods-by-class-">Methods (by class)</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Giuseppe Palermo, Thomas Jaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

