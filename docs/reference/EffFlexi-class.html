<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Class for the efficacy model in flexible form for prior expressed in form of pseudo data — EffFlexi-class • crmPack</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Class for the efficacy model in flexible form for prior expressed in form of pseudo data — EffFlexi-class" />

<meta property="og:description" content="This is a class where a flexible form is used to describe the realtionship between the efficacy
responses and the dose levels. This flexible form aims to capture different shape for the 
dose-efficacy curve and the mean efficacy responses at each dose level are estimated using MCMC.
In addition, the first (RW1) or second order (RW2) random walk model can be used for smoothing data. That is 
the random walk model is used to model the first or the second order differnece of the mean 
efficacy responses to its neighbouring dose levels of their mean efficacy responses.
The flexible form is specified as 
$$\mathbf{W}\vert\boldsymbol{\beta_w}, \sigma^2 \sim Normal (\mathbf{X}_w \boldsymbol{\beta_w}, \sigma^2 \mathbf{I})$$
where \(\mathbf{W}\) represent the column vector of the efficacy responses, \(\boldsymbol{\beta_w}\)
is th column vector of the mean efficacy responses for all dose levels, \(\mathbf{X_w}\) is the 
design matrix with entries \(I_{i(j)}\) which gives a value 1 if subject i is allocated to 
dose j. The \(\sigma^2\) (sigma2) is the variance of the efficacy responses which can be either fixed or from
an inverse gamma distribution." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crmPack</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Class for the efficacy model in flexible form for prior expressed in form of pseudo data</h1>
    <small class="dont-index">Source: <a href='https://github.com/roche/crmPack/blob/master/R/Model-class.R'><code>R/Model-class.R</code></a></small>
    <div class="hidden name"><code>EffFlexi-class.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is a class where a flexible form is used to describe the realtionship between the efficacy
responses and the dose levels. This flexible form aims to capture different shape for the 
dose-efficacy curve and the mean efficacy responses at each dose level are estimated using MCMC.
In addition, the first (RW1) or second order (RW2) random walk model can be used for smoothing data. That is 
the random walk model is used to model the first or the second order differnece of the mean 
efficacy responses to its neighbouring dose levels of their mean efficacy responses.
The flexible form is specified as 
$$\mathbf{W}\vert\boldsymbol{\beta_w}, \sigma^2 \sim Normal (\mathbf{X}_w \boldsymbol{\beta_w}, \sigma^2 \mathbf{I})$$
where \(\mathbf{W}\) represent the column vector of the efficacy responses, \(\boldsymbol{\beta_w}\)
is th column vector of the mean efficacy responses for all dose levels, \(\mathbf{X_w}\) is the 
design matrix with entries \(I_{i(j)}\) which gives a value 1 if subject i is allocated to 
dose j. The \(\sigma^2\) (sigma2) is the variance of the efficacy responses which can be either fixed or from
an inverse gamma distribution.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The RW1 model is given as 
$$\beta_{W,(j)} - \beta_{W,(j-1)} \sim Normal(0, \sigma^{2}_{\beta_{W}})$$
where \(\beta_{W,(j)}\) is the mean efficacy responses at dose j
For the RW2 is given as 
$$\beta_{W,(j-2)} - 2 \beta_{W,(j-1)} + \beta_{W,(j)} \sim Normal(0, \sigma^{2}_{\beta_{W}})$$
The variance parameter \(\sigma^{2}_{\beta_{W}}\). The variance \(\sigma^{2}_{\beta_{W}}\) 
(sigma2betaW) will be the same at all dose levels and can
either be fixed or assigned an inverse gamma prior distribution.</p>
<p>The <code>Eff</code> and <code>Effdose</code> are the pseduo efficacy responses and dose levels at which these 
pseudo efficacy responses are observed at. (see more details for <code><a href='Effloglog-class.html'>Effloglog</a></code> class)
<code>Eff</code> and <code>Effdose</code> must be vector of at least length 2. The values or elements in vectors
<code>Eff</code> or <code>Effdose</code> must put in the same position with its corresponding value in the other 
vector. The <code>sigma2</code> is the prior variance of the flexible efficacy form. The variance is either specified
with a single scalar value (fixed) or postive scalar value have to be specified for the <code>a</code> shape and 
<code>b</code> slope parameter for th inverse gamme distribtuion. Similarly, <code>sigma2betaW</code> is the prior variance 
of the random walk model which can be specified with a single scalar (fixed) value or specifying positive 
scalar values for the shape <code>a</code> and rate <code>b</code> parameters for the inverse gamma distributions. 
This model will output the updated value or the updated values of the paramters of the inverse gamma
distributions for \(sigma^2\) (sigma2) and \(\sigma^2_{\beta_W}\) (sigma2betaW)</p>
    
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    
    <dl class='dl-horizontal'>
<dt><code>Eff</code></dt><dd><p>the pseudo efficacy responses. A vector of at least length 2 with the elements here and its 
corresponding value in <code>Effdose</code> must be specified in the same position. (see dtails above)</p></dd>
    <dt><code>Effdose</code></dt><dd><p>the dose levels at which the pseudo efficacy responses are observed. This is a vector of at 
least length 2 and the elements here and its corrresponding value in <code>Eff</code> must be specified in the
same postion. (see details from above)</p></dd>
    <dt><code>sigma2</code></dt><dd><p>the prior variance of the flexible efficacy form. It can be specified with a single positive
scalar or specifying <code>a</code>, the shape and <code>b</code>, the rate parameter of the inverse gamma 
distribution. (see details from above)</p></dd>
    <dt><code>sigma2betaW</code></dt><dd><p>the prior variance of the random walk model for the mean efficact responses. A single
positve scalar can be specified or specifying <code>a</code>, the shape and <code>b</code>, the rate parameter of 
the inverse gamma distribution (see details from above)</p></dd>
    <dt><code>useFixed</code></dt><dd><p>a list of with logical value to each of the parameters <code>sigma2</code> and <code>sigma2betaw</code>
indicating whether a fixed value is used or not; this slot is needed for internal purposes and not to
be touched by the user.</p></dd>
    <dt><code>useRW1</code></dt><dd><p>for specifying the random walk model for the mean efficacy responses; if <code>TRUE</code>, 
first order random walk model is used, otherwise the second-order random walk model.</p></dd>
    <dt><code>designW</code></dt><dd><p>is the design matrix for the efficacy responses. If only the pseudo efficacy responses 
are used, this will be the design matrix of the pseudo efficacy responses. If there are some observed
efficacy responses available. It will be the design matrix based on both the pseudo and the observed
efficacy responses.</p></dd>
    <dt><code>RWmat</code></dt><dd><p>is the the difference matrix for the random walk model. This slot is needed for internal 
purposes and not to be touched by the user.</p></dd>
    <dt><code>RWmatRank</code></dt><dd><p>is the rank of the difference matrix. This slot is needed for internal purposes and not
to be touched by the user.</p></dd>
</dl>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##Obtain prior estimates for the EffFlexi (efficacy model) given the pseudo data.</span>
<span class='co'>##First define an empty data set by only define the dose levels used in the study</span>
<span class='co'>## 12 dose levels are usesd from 25 to 300 mg with increments of 25.</span>
<span class='no'>emptydata</span><span class='kw'>&lt;-</span><span class='fu'><a href='DataDual.html'>DataDual</a></span>(<span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span>))
<span class='no'>data</span><span class='kw'>&lt;-</span><span class='no'>emptydata</span>
<span class='co'>## define the pseudo data as first fixed 2 dose levels 25 and 300 mg and </span>
<span class='co'>## specified in (Effdose slot).</span>
<span class='co'>## Then the efficacy responses observed at these two dose levels are 1.223 and 2.513 and </span>
<span class='co'>## specified in (Eff slot).</span>
<span class='co'>## The prior variance of the pseudo efficay responses. This can be either a fixed value of </span>
<span class='co'>## specifying the shape (a) and the rate (b) parameters for the inverse gamma distribution </span>
<span class='co'>## in (sigma2 slot). The prior variance of the random walk model which can be a fixed value or </span>
<span class='co'>## two value for the shape (a) and rate (b) parameter of the inverse gamma distribution in </span>
<span class='co'>## (sigma2betaW slot). The data are specified in (data slot)</span>


<span class='no'>Effmodel</span><span class='kw'>&lt;-</span> <span class='fu'><a href='EffFlexi.html'>EffFlexi</a></span>(<span class='kw'>Eff</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.223</span>, <span class='fl'>2.513</span>),<span class='kw'>Effdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),
                    <span class='kw'>sigma2</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0.1</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>0.1</span>),<span class='kw'>sigma2betaW</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>20</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>50</span>),
                    <span class='kw'>smooth</span><span class='kw'>=</span><span class='st'>"RW2"</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)

<span class='co'>##Obtain estimates from the model given some observed responses</span>
<span class='co'>## first specified the data</span>
<span class='no'>data</span><span class='kw'>&lt;-</span><span class='fu'><a href='DataDual.html'>DataDual</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>75</span>,<span class='fl'>100</span>,<span class='fl'>100</span>,<span class='fl'>225</span>,<span class='fl'>300</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>),
               <span class='kw'>w</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.31</span>,<span class='fl'>0.42</span>,<span class='fl'>0.59</span>,<span class='fl'>0.45</span>,<span class='fl'>0.6</span>,<span class='fl'>0.7</span>,<span class='fl'>0.6</span>,<span class='fl'>0.52</span>),
               <span class='kw'>doseGrid</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>25</span>,<span class='fl'>300</span>,<span class='fl'>25</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: Used default patient IDs!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Used best guess cohort indices!</span></div><div class='input'>
<span class='no'>Effmodel</span><span class='kw'>&lt;-</span> <span class='fu'><a href='EffFlexi.html'>EffFlexi</a></span>(<span class='kw'>Eff</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1.223</span>, <span class='fl'>2.513</span>),<span class='kw'>Effdose</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>25</span>,<span class='fl'>300</span>),
                    <span class='kw'>sigma2</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0.1</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>0.1</span>),<span class='kw'>sigma2betaW</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>20</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>50</span>),
                    <span class='kw'>smooth</span><span class='kw'>=</span><span class='st'>"RW2"</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>data</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#slots">Slots</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Giuseppe Palermo, Thomas Jaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

